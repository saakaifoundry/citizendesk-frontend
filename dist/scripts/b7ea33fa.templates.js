angular.module("citizendeskFrontendApp").run(["$templateCache",function(a){"use strict";a.put("views/assign.html",'<h3>\n  <span class="glyphicon glyphicon-user"></span>\n  <span translate>Assign to:</span>\n</h3>\n<div>\n  <button type="button" class="btn btn-info btn-lg btn-block"\n          ng-click="assignTo(identity._id)"\n          ng-disabled="disabled"\n          >\n    <span translate>\n      Me\n    </span>\n    <span ng-show="totals[identity._id]">({{totals[identity._id]}})</span>\n  </button>\n</div>\n<div ng-repeat="user in users" ng-hide="user._id === identity._id">\n  <button type="button" class="btn btn-default btn-lg btn-block"\n          ng-click="assignTo(user._id)"\n          ng-disabled="disabled"\n          >\n    <span\n          ng-bind="user.username"\n       ></span>\n    <span ng-show="totals[user._id]">({{totals[user._id]}})</span>\n  </button>\n</div>\n<div>\n  <button type="button" class="btn btn-warning btn-lg btn-block"\n          ng-click="back()"\n          ng-disabled="disabled"\n          >\n    <span class="glyphicon glyphicon-arrow-left"></span>\n    <span translate>Go back</span>\n  </button>\n</div>'),a.put("views/assigned-to-me.html",'<h3 translate>\n  Items assigned to you <small>for verification or publishing</small>\n</h3>\n\n<div class="input-group form-inline container">\n  <!-- new -->\n  <div class="form-group col-xs-12 col-md-3 col-lg-3">\n    <label class="control-label sr-only" for="filter">Filter</label>\n    <div class="controls">\n      <select id="filter"\n              name="filter"\n              class="form-control"\n              \n              ng-model="order"\n              ng-options="obj.value as obj.text for obj in filterOptArr"\n              ng-init="order=\'newest\'"\n              >\n      </select>\n    </div>\n  </div>\n\n  <!-- type -->\n  <div class="form-group col-xs-12 col-md-3 col-lg-3">\n    <label class="control-label sr-only" for="type">Type</label>\n    <div class="controls">\n      <select id="type"\n              name="type"\n              class="form-control"\n\n              ng-model="type"\n              ng-options="obj.value as obj.text for obj in typeOptArr"\n              ng-init="type=0"\n              >\n      </select>\n    </div>\n  </div>\n\n  <!-- verfication -->\n  <div class="form-group col-xs-12 col-md-3 col-lg-3">\n    <label class="control-label sr-only" for="modifier">Verification Status</label>\n    <div class="controls">\n      <select id="verified"\n              name="verified"\n              class="form-control"\n\n              ng-model="verified"\n              ng-options="obj.value as obj.text for obj in verOptArr"\n              ng-init="verified=verOptArr[3].value"\n              >\n      </select>\n    </div>\n  </div>\n\n  <!-- published -->\n  <div class="form-group col-xs-12 col-md-3 col-lg-3">\n    <label class="control-label sr-only" for="published-state">Published State</label>\n    <div class="controls">\n      <select id="published-state"\n              name="published-state"\n              class="form-control"\n\n              ng-model="published"\n              ng-options="obj.value as obj.text for obj in pubOptArr"\n              ng-init="published=pubOptArr[2].value"\n              >\n      </select>\n    </div>\n  </div>\n</div>\n<!-- search -->\n<div class="input-group">\n  <div class="input-group-addon">\n    <span class="glyphicon glyphicon-search"></span>\n  </div>\n  <label for="search" class="sr-only">Search</label>\n  <input class="form-control" type="search" placeholder="Search" ng-model="q" name="search" />\n</div>\n\n<!-- \n<pre>Type Filter: {{ type | json}}</pre>\n<pre>Verified Status: {{ verified | json }}</pre>\n<pre>Published Status: {{ published | json }}</pre> \n-->\n\n<div\n   ng-repeat="report in reports |\n              filter:q |\n              filter:type |\n              filter:verified |\n              filter:published"\n   ng-switch on="report.feed_type"\n   ng-class="{\'verified\': report.status==\'verified\',\n'+"              'debunked': report.status=='debunked',\n              'published': report.coverages.published.length === 1,\n              'tweet': report.feed_type === 'tweet',\n              'sms': report.feed_type === 'sms',\n              'recieved': report.channels[0].value === 'received',\n              'sent': report.channels[0].value === 'sent'}\"\n   >\n  <div ng-switch-when=\"tweet\" tweet-summary></div>\n  <div ng-switch-default      report-summary></div>\n</div>\n\n<div ng-show=\"loading\">\n  <h5 class=\"text-center\" translate>Loadingâ€¦</h5>\n  <div class=\"text-center\">\n    <span class=\"fa fa-refresh fa-spin\"></span>\n  </div>\n</div>\n\n<p ng-hide=\"loading || reports.length\" translate>\n  There are no reports assigned to you yet. You can go to\n  the <a href=\"#/queues/\">incoming reports page</a> to pick something\n  interesting\n</p>\n"),a.put("views/assigned.html",'<h3 translate>\n  Reports assigned to users\n</h3>\n<div class="list-group">\n  <div class="list-group-item"\n       ng-repeat="user in users"\n       ng-if="totals[user._id] !== 0">\n    <a ng-href="#/assigned-to/{{user._id}}/{{user.username}}">\n      <span ng-bind="user.username"></span>\n      <span class="badge" ng-bind="totals[user._id]">\n      </span>\n    </a>\n  </div>\n  <div class="list-group-item"\n       ng-repeat="user in users"\n       ng-if="totals[user._id] === 0">\n    <a ng-href="#/assigned-to/{{user._id}}/{{user.username}}">\n      <span ng-bind="user.username"></span>\n      <span class="badge" ng-bind="totals[user._id]">\n      </span>\n    </a>\n  </div>\n</div>\n'),a.put("views/associate-alias.html",'<h3 translate>Associate an alias with an identity</h3>\n<p translate>\n  Is {{alias.identifiers.user_name_search}} used by\n  {{identity.first_name}} {{identity.last_name}}?\n</p>\n<button ng-click="confirm()">\n  <span translate>Yes</span>\n</button>\n<button ng-click="cancel()">\n  <span translate>No</span>\n</button>\n'),a.put("views/citizen-card.html",'<h3 translate>\n  Info about alias <span>{{alias.identifiers.user_name_search}}</span>\n</h3>\n<div ng-switch="alias.authority">\n  <div class="panel panel-info" ng-switch-when="twitter">\n    <div class="panel-heading"\n         >\n      Twitter alias\n    </div>\n    <div class="panel-body">\n      <div class="media">\n        <a class="pull-left"\n           ng-href="//twitter.com/{{alias.identifiers.user_name_search}}"\n           target="_blank"\n           >\n          <img class="media-object" ng-src="{{alias.avatars[0].https}}">\n        </a>\n        <div class="media-body">\n          <h5 class="media-heading"\n              ng-bind="alias.identifiers.user_name_search"\n              ></h5>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="panel panel-info" ng-switch-when="web">\n    <div class="panel-heading" translate>\n      Web alias\n    </div>\n  </div>\n  <div class="panel panel-info" ng-switch-when="telco">\n    <div class="panel-heading" translate>\n      Mobile alias\n    </div>\n  </div>\n</div>\n<div class="panel panel-default">\n  <div class="panel-body">\n    <div ng-hide="alias.identity_record_id">\n      <p translate>\n        This alias is not associated with any identity\n      </p>\n      <button class="btn btn-default" ng-click="associate()">\n        <span translate>\n          Associate with an identity\n        </span>\n      </button>\n    </div>\n    <div ng-show="alias.identity_record_id">\n      <address>\n        <strong>\n          <a ng-href="#/identity-record/{{alias.identity_record_id._id}}">\n            {{alias.identity_record_id.first_name}}\n            {{alias.identity_record_id.last_name}}\n          </a>\n        </strong><br>\n        <span ng-bind="alias.identity_record_id.location"></span><br>\n        <a href="mailto:#" ng-bind="alias.identity_record_id.email"></a>\n      </address>\n      <button class="btn btn-default" ng-click="associate()">\n        <span translate translate-comment="keep this short">\n          Change the associated identity\n        </span>\n      </button>\n    </div>\n  </div>\n</div>\n\n<div class="panel panel-default" ng-show="loading">\n\n  <div class="panel-body" ng-if="alias.tags.length===0">\n    \n      <p translate>\n        This alias is not associated with any list\n      </p>\n      <button class="btn btn-default" ng-click="editTags()">\n        <span translate>\n          Add to a list\n        </span>\n      </button>\n\n  </div>\n\n  <div class="panel-body" ng-if="alias.tags.length===1">\n\n    <p translate>\n      This alias belongs to the list below:\n    </p>\n    <p>\n      <label class="label" ng-class="alias.tags[0].variation"\n             ng-bind="alias.tags[0].name">\n      </label>\n    </p>\n    <button class="btn btn-default" ng-click="editTags()">\n      <span translate>\n        Change the list this alias belongs to\n      </span>\n    </button>\n\n  </div>\n\n</div>\n\n<div class="panel panel-default">\n  <div class="panel-body">\n\n    <p translate>\n      Reports authored by this user\n    </p>\n    <div\n       ng-repeat="report in reports"\n       ng-switch on="report.feed_type"\n       >\n      <div ng-switch-when="tweet" tweet-summary></div>\n      <div ng-switch-default      report-summary></div>\n    </div>\n    <div ng-hide="reports.length" translate>\n      No reports here at the moment\n    </div>\n  </div>\n</div>'),a.put("views/configure-account.html",'<ol class="breadcrumb">\n  <li><a href="#/configure" translate>Configure</a></li>\n  <li class="active" translate>Account</li>\n</ol>\n<p translate>\n  From this page you can change your password\n</p>\n<form name="form"  ng-submit="submit()">\n  <div class="form-group">\n    <label translate>Current password</label>\n    <input type="password" class="form-control"\n           ng-model="$parent.currentPassword"\n           required>\n  </div>\n  <div class="form-group">\n    <label translate>New password</label>\n    <input type="password" class="form-control"\n           ng-model="$parent.newPassword"\n           required>\n  </div>\n  <div class="form-group">\n    <label translate>Please confirm the new password</label>\n    <input type="password" class="form-control"\n           ng-model="$parent.confirmPassword"\n           required>\n  </div>\n  <div ng-messages="messages">\n    <div ng-message="passwordMismatch" class="alert alert-warning">\n      <span translate>\n        The two entries for the new password do not match\n      </span>\n    </div>\n    <div ng-message="authenticationFailure" class="alert alert-warning">\n      <span translate>\n        The current password is wrong, are you the right user? Citizen\n        Desk will log out in five seconds\n      </span>\n    </div>\n    <div ng-message="shortPassword" class="alert alert-warning">\n      <span translate>\n        We cannot save the new password, it is too short\n      </span>\n    </div>\n    <div ng-message="success" class="alert alert-success">\n      <span translate>\n        Your password has been updated\n      </span>\n    </div>\n  </div>\n  <span class="pull-right">\n    <button type="button" class="btn btn-default" ng-click="cancel()">\n      <span translate>Cancel</span>\n    </button>\n    <button type="submit" class="btn btn-primary"\n            ng-disabled="disableSubmit">\n      <span translate>Submit</span>\n    </button>\n  </span>\n</form>\n'),a.put("views/configure-autoreply.html",'<ol class="breadcrumb">\n  <li><a href="#/configure" translate>Configure</a></li>\n  <li class="active" translate>Autoreply</li>\n</ol>\n<form class="form-horizontal">\n  <fieldset ng-disabled="disabled">\n    <div class="form-group">\n      <label class="col-md-2">Autoreply enabled</label>\n      <div class="col-md-10">\n        <input type="checkbox" class="col-md-10 form-control"\n               ng-model="config.set.sms_reply_send">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-md-2">Text to send automatically</label>\n      <div class="col-md-10">\n        <textarea type="text" class="col-md-10 form-control"\n                  ng-model="config.set.sms_reply_message"></textarea>\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-md-2">Session timeout in hours</label>\n      <div class="col-md-10">\n        <input type="number" class="col-md-10 form-control"\n               ng-model="config.set.sms_session_duration">\n      </div>\n    </div>\n    <div class="col-md-10 col-md-offset-2">\n      <button class="btn btn-primary" ng-click="save()">\n        <span translate>Save</span>\n      </button>\n    </div>\n  </fieldset>\n</form>\n'),a.put("views/configure-coverages.html",'<ol class="breadcrumb">\n  <li><a href="#/configure" translate>Configure</a></li>\n  <li class="active" translate>Coverages</li>\n</ol>\n<p>\n  <span translate>\n    Changing these settings will not change reports already published\n    to existing coverages\n  </span>\n</p>\n<div ng-repeat="coverage in coverages">\n  <div class="form-group">\n    <label class="col-md-2" translate>Title</label>\n    <div class="col-md-10">\n      <input type="text"\n             class="col-md-10 form-control" ng-model="coverage.title">\n    </div>\n  </div>\n  <div class="form-group">\n    <div class="col-md-10 col-md-offset-2">\n      <div class="checkbox">\n        <label>\n          <input type="checkbox"\n                 ng-model="coverage.active">\n          <span translate>Active</span>\n        </label>\n      </div>\n    </div>\n  </div>\n  <div class="form-group">\n    <div class="col-md-10 col-md-offset-2">\n      <button class="btn btn-primary" ng-click="save(coverage)"\n              ng-disabled="disabled">\n        <span translate>Save</span>\n      </button>\n      <button class="btn btn-danger" ng-click="remove(coverage)"\n              ng-disabled="disabled">\n        <span translate>Delete</span>\n      </button>\n    </div>\n  </div>\n  <!-- had troubles applying ng-repeat directly to `p`, so i add an\n  empty `p` in order to have the bottom padding -->\n  <p>\n    &nbsp;\n  </p>\n</div>\n<p class="col-md-10 col-md-offset-2">\n  <button class="btn btn-warning" ng-click="add()">\n    <span translate>Add</span>\n  </button>\n</p>\n<div class="clearfix"></div>\n'),a.put("views/configure-lists-specific.html",'<ol class="breadcrumb">\n  <li><a href="#/configure" translate>Configure</a></li>\n  <li><a href="#/configure-lists" translate>Citizen lists</a></li>\n  <li ng-hide="newList" class="active" ng-bind="list.name"></li>\n  <li ng-show="newList" class="active">\n    <span translate>New list</span>\n  </li>\n</ol>\n<form ng-submit="save()" name="form">\n  <div class="form-group">\n    <label for="name" translate>List name</label>\n    <input class="form-control" id="name"\n           ng-model="list.name"\n           placeholder="{{\'List name\'|translate}}"\n           required>\n  </div>\n  <div class="form-group">\n    <label for="variation" translate>Style for the list label</label>\n    <select class="form-control" id="variation"\n            ng-model="list.variation"\n            ng-options="variation.class as variation.name for variation in variations">\n    </select>\n  </div>\n  <div class="form-group">\n    <label translate>Preview</label>\n    <p class="form-control-static">\n      <label class="label" ng-class="list.variation" ng-bind="list.name">\n      </label>\n    </p>\n  </div>\n  <button type="button" class="btn btn-default"\n          ng-click="back()"\n          translate>Cancel</button>\n  <button type="submit" class="btn btn-primary" ng-disabled="disabled"\n          translate>\n    Save\n  </button>\n</form>\n<p></p>\n<div ng-show="deletable">\n  <button type="button" class="btn btn-default"\n          ng-click="delete()"\n          ng-disabled="disabled"\n          translate>Delete</button>\n  <p></p>\n  <p translate>\n    This list does not contain any citizen\n  </p>\n</div>\n<div ng-show="aliases.length">\n  <p translate>\n    This list cannot be deleted, because some citizens belong to\n    it. Please remove the citizens from the list in order to delete it\n  </p>\n  <p translate>\n    Citizens belonging to this list:\n  </p>\n  <div ng-repeat="alias in aliases">\n    <a ng-bind="alias.identifiers.user_name"\n       ng-href="#/citizen-card/{{alias.authority}}/{{alias.identifiers.user_name}}"\n       ></a>\n  </div>\n</div>\n'),a.put("views/configure-lists.html",'<ol class="breadcrumb">\n  <li><a href="#/configure" translate>Configure</a></li>\n  <li class="active" translate>Citizen lists</a></li>\n</ol>\n<p ng-repeat="list in lists" class="clearfix">\n  <label class="label" ng-class="list.variation" ng-bind="list.name">\n  </label>\n  <button ng-click="edit(list)" class="btn btn-default pull-right">\n    <span translate>Edit</span>\n  </button>\n</p>\n<p>\n  <button ng-click="create()" class="btn btn-default pull-right">\n    <span translate>Create a new list</span>\n  </button>\n</p>\n<p class="clearfix"></p>\n'),a.put("views/configure-status-presentation.html",'<ol class="breadcrumb">\n  <li><a href="#/configure" translate>Configure</a></li>\n  <li class="active" translate>Status presentation</li>\n</ol>\n<p>\n  <span translate>\n    Modify these texts in order to change the way verification status\n    is presented to the readers\n  </span>\n</p>\n<div ng-repeat="status in statuses">\n  <div class="form-group">\n    <label class="col-md-2" ng-bind="status.key"></label>\n    <div class="col-md-8">\n      <input type="text"\n             class="form-control" ng-model="status.description">\n    </div>\n    <div class="col-md-2">\n      <button class="btn btn-primary" ng-click="save(status)"\n              ng-disabled="disabled">\n        <span translate>Save</span>\n      </button>\n    </div>\n  </div>\n  <!-- had troubles applying ng-repeat directly to `p`, so i add an\n  empty `p` in order to have the bottom padding -->\n  <p>&nbsp;</p>\n</div>\n'),a.put("views/configure-steps.html",'<ol class="breadcrumb">\n  <li><a href="#/configure" translate>Configure</a></li>\n  <li class="active" translate>Validation steps</li>\n</ol>\n<div class="form-group">\n  <p class="help-block" translate>\n    Changing these settings will not affect reports that already started\n    the verification process\n  </p>\n</div>\n<div ng-repeat="step in steps">\n  <div class="form-group">\n    <label class="col-md-2" translate>Description</label>\n    <div class="col-md-10">\n      <input type="text"\n             class="col-md-10 form-control" ng-model="step.description">\n    </div>\n  </div>\n  <div class="form-group">\n    <div class="col-md-10 col-md-offset-2">\n      <div class="checkbox">\n        <label>\n          <input type="checkbox"\n                 ng-model="step.mandatory">\n          <span translate>Required</span>\n        </label>\n      </div>\n    </div>\n  </div>\n  <div class="form-group">\n    <div class="col-md-10 col-md-offset-2">\n      <button class="btn btn-primary" ng-click="save(step)"\n              ng-disabled="disabled">\n        <span translate>Save</span>\n      </button>\n      <button class="btn btn-danger" ng-click="remove(step)"\n              ng-disabled="disabled">\n        <span translate>Delete</span>\n      </button>\n    </div>\n  </div>\n  <!-- had troubles applying ng-repeat directly to `p`, so i add an\n  empty `p` in order to have the bottom padding -->\n  <p>\n    &nbsp;\n  </p>\n</div>\n<p class="col-md-10 col-md-offset-2">\n  <button class="btn btn-warning" ng-click="add()">\n    <span translate>Add</span>\n  </button>\n</p>\n<div class="clearfix"></div>\n'),a.put("views/configure-time-zone.html",'<ol class="breadcrumb">\n  <li><a href="#/configure" translate>Configure</a></li>\n  <li class="active" translate>Time zone</li>\n</ol>\n<p translate>\n  All time data showed in the application is converted to your time\n  zone. The time zone cannot be customised by this application, it\n  being a setting of the operative system.\n</p>\n<p translate>\n  This means that you have to configure the time zone either in\n  Android or in iOS, Windows, Linux, or the system installed on your\n  machine.\n</p>\n<p translate>\n  You can come back to this page in order to check that your current\n  time zone settings are accurate.\n</p>\n<h4 translate>\n  Your current time zone is UTC {{offsetString}}\n</h4>  \n'),a.put("views/configure-twitter-ingestion-oauths.html",'<ol class="breadcrumb">\n  <li><a href="#/configure" translate>Configure</a></li>\n  <li class="active" translate>Twitter monitor key</li>\n</ol>\n<form ng-show="key" class="form-horizontal">\n  <fieldset ng-disabled="disabled">\n    <div class="form-group">\n      <label class="col-md-2">\n        API key\n      </label>\n      <div class="col-md-10">\n        <input type="text" class="col-md-10 form-control"\n               placeholder="aBcDeFgHiLmNoPqRsTuVz"\n               ng-model="key.spec.consumer_key"\n               required>\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-md-2">\n        API secret\n      </label>\n      <div class="col-md-10">\n        <input type="text" class="col-md-10 form-control"\n               placeholder="aBcDeFgHiLmNoPqRsTuVz"\n               ng-model="key.spec.consumer_secret"\n               required>\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-md-2">\n        Access token\n      </label>\n      <div class="col-md-10">\n        <input\n           type="text"\n           class="col-md-10 form-control"\n           placeholder="aBcDeFgHiLmNoPqRsTuVz"\n           ng-model="key.spec.access_token_key">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-md-2">\n        Access token secret\n      </label>\n      <div class="col-md-10">\n        <input type="text" class="form-control"\n               placeholder="aBcDeFgHiLmNoPqRsTuVz"\n               ng-model="key.spec.access_token_secret"\n               required>\n      </div>\n    </div>\n    <div class="col-md-10 col-md-offset-2" ng-if="editing">\n      <button class="btn btn-primary" ng-click="save()">\n        <span translate>\n          Save\n        </span>\n      </button>\n      <button class="btn btn-default" ng-click="cancelEdit()">\n        <span translate>\n          Cancel editing\n        </span>\n      </button>\n    </div>\n  </fieldset>\n</form>\n<div class="col-md-10 col-md-offset-2" ng-if="!editing && !noKey">\n  <button class="btn btn-primary" ng-click="edit()">\n    <span translate>\n      Edit\n    </span>\n  </button>\n</div>\n<div ng-show="noKey">\n  <p translate>\n    There are no Twitter monitor keys set up for you. You need to add\n    one in order to be able to define Twitter monitors\n  </p>\n  <p class="text-center">\n    <button class="btn btn-primary" ng-click="add()">\n      <span translate>Add a key</span>\n    </button>\n  </p>\n  <p>\n    <a target="_blank"\n       href="http://iag.me/socialmedia/how-to-create-a-twitter-app-in-8-easy-steps/"\n       translate>\n      How do I get a key? (tutorial in English)\n    </a>\n  </p>\n</div>\n'),a.put("views/configure.html",'<ol class="breadcrumb">\n  <li class="active" translate>Configure</li>\n</ol>\n<div class="list-group">\n  <!--a href="#/configure-twitter-ingestion" class="list-group-item" translate>\n    Twitter ingestion\n  </a-->\n  <a href="#/configure-lists" class="list-group-item" translate>\n    Citizen lists\n  </a>\n  <a href="#/configure-autoreply" class="list-group-item" translate>\n    Autoreply\n  </a>\n  <a href="#/configure-steps" class="list-group-item" translate>\n    Validation steps\n  </a>\n  <a href="#/configure-coverages" class="list-group-item" translate>\n    Coverages\n  </a>\n  <a href="#/configure-twitter-ingestion-oauths"\n     class="list-group-item" translate>\n    Twitter monitor key\n  </a>\n  <a href="#/configure-status-presentation"\n     class="list-group-item" translate>\n    Status presentation\n  </a>\n  <a href="#/configure-time-zone"\n     class="list-group-item" translate>\n    Time zone\n  </a>\n  <a href="#/list-identity-records"\n     class="list-group-item" translate>\n    Known Identites\n  </a>\n  <a href="#/configure-account"\n     class="list-group-item" translate>\n    Account\n  </a>\n</div>\n'),a.put("views/directives/common-report-detail-part.html",'<div ng-controller="CommonReportDetailPartCtrl">\n  <div class="alert alert-{{status}}"\n       ng-hide="alert==\'\'"\n       ng-bind="alert"></div>\n  <!-- the verification block follows, disabled for local reports,\n       like the mobile session summaries for example -->\n  <div ng-hide="report.local">\n    <h4 translate>Verification checklist</h4>\n    <div class="container">\n      <form id="tasks" class="form-horizontal" ng-repeat="step in report.steps">\n        <div class="form-group">\n          <div class="checkbox">\n            <label>\n              <input type="checkbox"\n                     ng-model="step.done"\n                     ng-change="changeStep(step.done)"\n                     >\n              {{step.description}}\n              <span ng-if="step.mandatory"\n                    ng-hide="step.done"\n                    class="glyphicon glyphicon-exclamation-sign"></span>\n            </label>\n          </div>\n        </div>\n      </form>\n    </div>\n    <div ng-switch="largeScreen">\n      <div ng-switch-when="true">\n        <p class="btn-group btn-group-justified">\n          <label class="btn btn-default" ng-model="report.status"\n                 ng-class="{\'btn-success\': report.status==\'verified\'}"\n                 ng-disabled="disabled || verificationDisabled"\n                 btn-radio="\'verified\'">\n            <span class="glyphicon glyphicon-ok"></span>\n            <span translate>\n              Verified!\n            </span>\n          </label>\n          <label class="btn btn-default" ng-model="report.status"\n                 ng-disabled="disabled"\n                 btn-radio="\'\'">\n            <span translate>\n              Unknown\n            </span>\n          </label>\n          <label class="btn btn-default" ng-model="report.status"\n                 ng-class="{\'btn-danger\': report.status==\'debunked\'}"\n                 ng-disabled="disabled"\n                 btn-radio="\'debunked\'">\n            <span class="glyphicon glyphicon-warning-sign"></span>\n            <span translate>\n              This is false\n            </span>\n          </label>\n        </p>\n      </div>\n      <div ng-switch-default>\n        <p class="btn-group btn-group-justified">\n          <label class="btn btn-default" ng-model="report.status"\n                 ng-class="{\'btn-danger\': report.status==\'debunked\'}"\n                 ng-disabled="disabled"\n                 btn-radio="\'debunked\'">\n            <span translate>\n              This is false\n            </span>\n          </label>\n        </p>\n        <p class="btn-group btn-group-justified">\n          <label class="btn btn-default" ng-model="report.status"\n                 ng-disabled="disabled"\n                 btn-radio="\'\'">\n            <span translate>\n              Unknown\n            </span>\n          </label>\n        </p>\n        <p class="btn-group btn-group-justified">\n          <label class="btn btn-default" ng-model="report.status"\n                 ng-class="{\'btn-success\': report.status==\'verified\'}"\n                 ng-disabled="disabled || verificationDisabled"\n                 btn-radio="\'verified\'">\n            <span translate>\n              Verified!\n            </span>\n          </label>\n        </p>\n      </div>\n    </div>\n  </div>\n  <div>\n    <div class="form-group">\n      <div class="checkbox">\n        <label>\n          <input type="checkbox" ng-model="comment">\n          <span translate>Add a comment to show on publish</span>\n        </label>\n      </div>\n    </div>\n    <div class="row" ng-show="isPublished && onBehalf">\n      <div class="col-md-12">\n        <h5>\n          <span translate>Published by {{onBehalf.username}}</span>\n        </h5>\n      </div>\n    </div>\n    <div class="form-group" ng-show="comment">\n      <div ng-hide="isPublished">\n        <textarea class="form-control" rows="2"\n                  ng-model="report.notices_outer[0]"\n                  ng-model-options="{ debounce: 1000 }"\n                  ></textarea>\n      </div>\n      <div ng-show="isPublished" class="clearfix">\n        <textarea class="form-control" rows="2"\n                  ng-model="report.notices_outer[0]"\n                  ></textarea>\n        <span class="pull-right">\n          <button class="btn btn-default"\n                  ng-click="report.notices_outer[0] = commentCopy"\n                  ng-disabled="disabled"\n                  >\n            <span translate>Cancel</span>\n          </button>\n          <button class="btn btn-primary"\n                  ng-click="save()"\n                  ng-disabled="disabled"\n                  >\n            <span translate>Save</span>\n          </button>\n        </span>\n      </div>\n    </div>\n  </div>\n  <div class="row">\n    <div class="col-md-4 col-xs-4">\n      <button class="btn btn-warning" ng-if="!isPublished"\n              ng-disabled="disablePublish || (!selectedCoverage)"\n              ng-click="publish()">\n        <span translate>Publish</span>\n        <span class="glyphicon glyphicon-send"></span>\n      </button>\n      <button class="btn btn-warning" ng-if="isPublished"\n              ng-disabled="disablePublish"\n              ng-click="unpublish()">\n        <span translate>Unpublish</span>\n        <span class="glyphicon glyphicon-remove"></span>\n      </button>\n    </div>\n    <div class="col-md-8 col-xs-8">\n      <select class="form-control" ng-model="selectedCoverage"\n              ng-options="coverage.title for coverage in coverages"\n              ng-disabled="isPublished"\n              >\n      </select>\n    </div>\n  </div>\n  <p>&nbsp;</p>\n</div>\n'),a.put("views/directives/queue-selection.html",'<div class="dropdown" ng-controller="QueueSelectionCtrl">\n  <h3 dropdown-toggle>\n    <a ng-bind="service.description"></a>\n  </h3>\n  <ul class="dropdown-menu">\n    <li>\n      <a ng-href="#/mobile-queue">\n        <span>Mobile reports</span>\n      </a>\n    </li>\n    <li class="divider"></li>\n    <li>\n      <a ng-href="#/new-twitter-search">\n        <span>New Twitter search</span>\n      </a>\n    </li>\n    <li class="divider"></li>\n    <li ng-repeat="queue in searches">\n      <a ng-href="#/twitter-search/{{queue._id}}">\n        <span ng-bind="queue.description"></span>\n        <span class="badge" ng-bind="queue.reports.length"></span>\n      </a>\n    </li>\n    <li ng-repeat="queue in monitors">\n      <a ng-href="#/monitor/{{queue.slug}}">\n        <span ng-bind="queue.description"></span>\n        <span class="badge" ng-bind="queue.reports.length"></span>\n      </a>\n    </li>\n  </ul>\n</div>\n'),a.put("views/directives/report-author.html",'<!-- link to the citizen card just if not a local author, see comments\n     on\n     https://github.com/sourcefabric-innovation/citizendesk-frontend/issues/53\n     -->\n<a ng-href="#/citizen-card/{{author.authority}}/{{author.identifiers.user_name}}"\n   ng-hide="author.authority === \'citizen_desk\'"\n   >\n  <span ng-bind="author.identifiers.user_name"></span>\n  <span ng-if="author.alias.identity_record_id.first_name">\n    ({{author.alias.identity_record_id.first_name}}\n    {{author.alias.identity_record_id.last_name}})\n  </span>\n</a>\n<strong ng-bind="author.identifiers.user_display_name"\n        ng-show="author.authority === \'citizen_desk\'"\n        >\n</strong>\n'),a.put("views/directives/report-summary-buttons.html",'<span class="pull-right" ng-switch="report.verified">\n  <a href="#/report-{{report.feed_type}}/{{report._id}}"\n     class="btn btn-info"\n     ng-switch-when="true"\n     >\n    <span class="fa fa-search"></span>\n    <span translate>\n      Details\n    </span>\n  </a>\n  <span ng-switch-default>\n    <span ng-switch="report.assignments.length">\n      <a class="btn btn-warning"\n         ng-show="dismiss"\n         ng-click="dismiss(report)"\n         ng-disabled="disabled[report._id]"\n         >\n        <span class="fa fa-trash-o"></span>\n        <span translate>\n          Dismiss\n        </span>\n      </a>\n      <span ng-switch-when="0">\n        <a class="btn btn-default"\n           ng-show="assign"\n           ng-click="assign(report)"\n           >\n          <span class="fa fa-users"></span>\n          <span translate>\n            Assign\n          </span>\n        </a>\n      </span>\n      <span ng-switch-default>\n        <a class="btn btn-info"\n           ng-show="assign"\n           ng-href="#/assigned/"\n           >\n          <span translate>\n            Assigned to {{report.assignments[0].user_id.username}}\n          </span>\n        </a>\n        <a class="btn btn-warning"\n           ng-show="assign"\n           ng-click="assign(report)"\n           >\n          <span class="fa fa-users"></span>\n          <span translate>\n            Reassign\n          </span>\n        </a>\n      </span>\n    </span>\n    <a href="#/report-{{report.feed_type}}/{{report._id}}"\n       class="btn btn-primary"\n       >\n      <span class="fa fa-search"></span>\n      <span translate>\n        Check\n      </span>\n    </a>\n  </span>\n</span>\n'),a.put("views/directives/report-summary.html",'<div\n   data-id="{{report._id}}"\n   class="panel panel-default"\n   >\n  <div class="panel-heading clearfix">\n    <h5>\n      <report-author author="report.authors[0]"></report-author>\n      <div>\n        <small ng-bind="report.produced | date:\'medium\'"></small>\n      </div>\n    </h5>\n    <span class="label pull-right"\n          ng-bind="report.authors[0].alias.tags[0].name"\n          ng-class="report.authors[0].alias.tags[0].variation">\n    </span>\n  </div>\n  <div class="panel-body break-long-words">\n    <p ng-repeat="text in report.texts"\n       ng-bind="text.original"></p>\n  </div>\n  <div class="panel-footer clearfix">\n    <div class="panel" ng-if="report.media[0]">\n      <img class="img-responsive center-block"\n           ng-src="{{report.media[0].link}}">\n    </div>\n    <span report-summary-buttons></span>\n  </div>\n</div>\n'),a.put("views/directives/tweet-summary.html",'<div\n   data-id="{{report._id}}"\n   scroll-target="report._id"\n   class="panel panel-default"\n   >\n  <div class="panel-heading clearfix" ng-if="report.authors[0].alias.tags[0]">\n    <span class="label pull-right"\n          ng-bind="report.authors[0].alias.tags[0].name"\n          ng-class="report.authors[0].alias.tags[0].variation">\n    </span>\n  </div>\n  <div class="panel-body break-long-words">\n    <p>\n      <div class="row">\n        <!-- avatar -->\n        <div class="col-md-2 col-xs-3">\n          <a target="_blank"\n             ng-href="//twitter.com/{{report.original.user.screen_name}}">\n            <img class="media-object"\n                 ng-src="{{report.original.user.profile_image_url_https}}">\n          </a>\n        </div>\n        <div class="col-md-10 col-xs-7">\n          <div>\n            <span ng-bind="report.produced | date:\'short\'"\n                  class="text-muted pull-right">\n            </span>\n            <!-- full name -->\n            <a target="_blank"\n               ng-href="//twitter.com/{{report.original.user.screen_name}}">\n              <strong ng-bind="report.original.user.name"></strong>\n            </a>\n            <!-- Twitter user name -->\n            <a target="_blank"\n               ng-href="//twitter.com/{{report.original.user.screen_name}}">\n              <span ng-bind="\'@\'+report.original.user.screen_name"\n                    class="text-muted">\n              </span>\n            </a>\n          </div>\n          <!-- middle part of the tweet -->\n          <p id="text"\n             ng-if="report.linkedText"\n             ng-bind-html="report.linkedText"\n             ng-class="lead"\n             >\n          </p>\n          <!-- this in case we do not have a linked text -->\n          <p id="text"\n             ng-if="!report.linkedText"\n             ng-bind-html="report.texts[0].original"\n             ng-class="lead"\n             >\n          </p>\n          <!-- lower part of the tweet -- actions -->\n          <div>\n            <a ng-href="https://twitter.com/intent/favorite?tweet_id={{report.original.id_str}}"\n               target="_blank">\n              <img\n                 src="//si0.twimg.com/images/dev/cms/intents/icons/favorite.png">\n            </a>\n            <a ng-href="https://twitter.com/intent/tweet?in_reply_to={{report.original.id_str}}"\n               target="_blank">\n              <img\n                 src="//si0.twimg.com/images/dev/cms/intents/icons/reply.png">\n            </a>\n            <a ng-href="https://twitter.com/intent/retweet?tweet_id={{report.original.id_str}}"\n               target="_blank">\n              <img\n                 src="//si0.twimg.com/images/dev/cms/intents/icons/retweet.png">\n            </a>\n          </div>\n        </div>\n      </div>\n    </p>\n  </div>\n  <div class="panel-footer clearfix">\n    <div class="panel" ng-repeat="medium in report.original.entities.media">\n      <img class="img-responsive center-block" ng-src="{{medium.media_url_https}}">\n    </div>\n    <span ng-show="report.original.entities.urls.length"\n          class="glyphicon glyphicon-link"></span>\n    <span report-summary-buttons></span> \n  </div>\n</div>\n'),a.put("views/edit-user-lists.html",'<form ng-submit="save()">\n  <h3 translate>\n    Citizen <span>{{alias.identifiers.user_name}}</span> belongs to list:\n  </h3>\n  <div class="row">\n    <div class="col-xs-8 col-md-8">\n      <select ng-model="currentList"\n              ng-options="list._id as list.name for list in lists"\n              class="form-control"\n              >\n        <option value=""><span translate>no list</span></option>\n      </select>\n    </div>\n    <div class="col-xs-4 col-md-4">\n      <button type="submit" class="btn btn-primary" ng-disabled="disabled">\n        <span translate>Save</span>\n      </button>\n    </div>\n  </div>\n</form>\n'),a.put("views/error-no-monitors.html",'<div class="alert alert-danger" translate>\n  There are no monitors defined\n</div>\n'),a.put("views/error-no-searches.html",'<div class="alert alert-danger" translate>\n  This twitter search does not exist. Maybe it was deleted. You\n  can <a href="#/new-twitter-search">define a new one</a>\n</div>\n'),a.put("views/help-tweet-queues.html",'<h3 translate>\n  <a href="#" ng-click="back()">\n    <small>\n      <span class="glyphicon glyphicon-chevron-left"></span>\n    </small>\n  </a>\n  How are incoming reports from Twitter organised?\n</h3>\n<p translate>\n  Reports come from Twitter in two flavors: <i>Monitors</i> and <i>Twitter Searches</i>.\n</p>\n<h4 translate>\n  Monitors\n</h4>\n<p translate>\n  <i>Monitors</i> follow your search terms in Twitter in real time. They will periodically show you the most recent tweets about the topic you set. You have to set your monitor to include keywords (like "Obama"), Twitter user names (like @joesmith), or hashtags (like #eurovision). You can monitor multiple items - just separate each monitored phrase with a comma. Since this may result in a huge amount of reports from Twitter, we only support search terms with a reduced number of matches. A typical use for a monitor is to watch your own Twitter username and the usernames of others.\n</p>\n<p translate>\n  To set up your monitor, you have to provide a Twitter API key. Thus every user can have a maximum of one monitor account, but with a large number of monitored terms. If you haven\'t done so already, Click on your monitor in order to start the set\n  up.\n</p>\n<h4 translate>\n  Twitter searches\n</h4>\n<p translate>\n  A Twitter search is different. It searches the past, while the monitor is looking forward. Twitter searches do not have the limitations that monitors do, but they are\n  not constantly updated. They are only updated just when you create or refresh them.\n</p>\n'),a.put("views/identity-record.html",'<h3 translate>\n  Identity record\n</h3>\n<div ng-if="identity.deleted" class="alert alert-danger">\n  <span translate>\n    <strong>This identity record was deleted!</strong> Someone deleted\n    this identity record, any alias associated with it should be\n    re-associated to a new, valid citizen identity\n  </span>\n</div>\n<form ng-submit="submit()">\n  <div class="form-group">\n    <label translate>First name</label>\n    <input class="form-control" ng-model="identity.first_name" required>\n  </div>\n  <div class="form-group">\n    <label translate>Last name</label>\n    <input class="form-control" ng-model="identity.last_name" required>\n  </div>\n  <div class="form-group">\n    <label translate>E-Mail</label>\n    <input class="form-control" ng-model="identity.email" type="email">\n  </div>\n  <div class="form-group">\n    <label translate>Location</label>\n    <input class="form-control" ng-model="identity.location">\n  </div>\n  <div class="clearfix">\n    <button type="button" class="btn btn-danger" ng-click="delete()"\n            ng-hide="hideDelete"\n            ng-disabled="deleteDisabled">\n      <span translate>Delete</span>\n    </button>\n    <span class="pull-right">\n      <button type="button" class="btn btn-default" ng-click="cancel()">\n        <span translate>Cancel</span>\n      </button>\n      <button type="submit" class="btn btn-primary"\n              ng-disabled="disabled">\n        <span translate>Save</span>\n      </button>\n    </span>\n  </div>\n  <p ng-show="aliases.length" class="help-block">\n    <span translate>\n      Deletion is disabled because this identity is associated with\n      some aliases\n    </span>\n  </p>\n</form>\n<div ng-show="aliases.length">\n  <h5 translate>This identity is associated with the aliases below:</h5>\n  <div class="list-group">\n    <a ng-repeat="al in aliases" class="list-group-item"\n       ng-href="#/citizen-card/{{al.authority}}/{{al.identifiers.user_name}}"\n       >\n      <span class="pull-right">\n        <span ng-if="al.authority === \'twitter\'"\n              class="fa fa-twitter"></span>\n        <span ng-if="al.authority === \'telco\'"\n              class="fa fa-phone"></span>\n      </span>\n      <span ng-bind="al.identifiers.user_name_search">\n      </span>\n    </a>\n  </div>\n</div>\n'),a.put("views/ingest-from-location.html",'<h3 translate>Add a report from a web location</h3>\n<form ng-submit="submit()">\n  <div class="form-group">\n    <label translate>Location</label>\n    <input type="url" placeholder="http://www.{{\'example\'|translate}}.com"\n           ng-model="location"\n           required\n           class="form-control"\n           >\n  </div>\n  <!--div class="checkbox">\n    <label>\n      <input type="checkbox" ng-model="assign">\n      <span translate>Assign immediately</span>\n    </label>\n  </div>\n  <div class="form-group" collapse="!assign">\n    <label translate>Assign to</label>\n    <select class="form-control" options="user in users"\n            ng-model="assignedTo">\n    </select>\n  </div-->\n  <div class="checkbox">\n    <label>\n      <input type="checkbox" ng-model="repeat">\n      <span translate>Add another</span>\n    </label>\n  </div>\n  <button class="btn btn-default" ng-click="cancel()">\n    <span translate>Cancel</span>\n  </button>\n  <button type="sumbit" class="btn btn-primary">\n    <span translate>Ingest</span>\n  </button>\n</form>\n<div ng-show="showConfirm"\n     class="alert alert-info alert-dismissable"\n     >\n  <button class="close" data-dismiss="alert">&times;</button>\n  <span translate>\n    The link has been added to the list of incoming web reports\n  </span>\n</div>\n'),a.put("views/list-from-the-web.html",'<h3 ng-bind="description"></h3>\n<p class="clearfix">\n  <button class="btn btn-default pull-right"\n          ng-click="goAdd()"\n          >\n    <span translate>Add a new link</span>\n  </button>\n</p>\n<div\n   ng-repeat="report in reports | filter:q"\n   ng-switch on="report.feed_type"\n   >\n  <div ng-switch-when="tweet" tweet-summary></div>\n  <div ng-switch-default      report-summary></div>\n</div>\n<div ng-show="loading">\n  <p>\n    <h5 class="text-center" translate>Loading...</h5>\n    <div class="text-center">\n      <span class="fa fa-refresh fa-spin"></span>\n    </div>\n  </p>\n</div>\n<div ng-hide="loading || reports.length" translate>\n  No reports in this queue\n</div>\n'),a.put("views/list-identity-records.html",'<!-- the user can navigate to this page from two locations, the\nconfiguration page and the citizen card. in the two cases there will\nbe different route parameters. we have to show either a title or a\nconfiguration breadcrumb, depending on the origin -->\n<div ng-switch="configuration">\n  <ol ng-switch-when="true" class="breadcrumb">\n    <li><a href="#/configure" translate>Configure</a></li>\n    <li class="active" translate>Known Identities</li>\n  </ol>\n  <h3 ng-switch-when="false"><span translate>Identity records</span></h3>\n  <p><span translate>There are currently {{identities.length}} records</span></p>\n</div>\n<div ng-hide="configuration">\n  <p translate>\n    Select an identity to associate the alias with\n  </p>\n</div>\n\n<!-- search users -->\n<div class="input-group ng-scope">\n    <div class="input-group-addon">\n      <span class="glyphicon glyphicon-search"></span>\n    </div>\n    <input class="form-control"\n           type="search"\n           ng-model="user"\n           placeholder="Search for an identity"\n           >\n</div>\n\n<div class="list-group">\n  <div class="list-group-item list-group-item-success"\n       ng-click="add()">\n      <span translate>Add a new identity</span>\n  </div>\n  <div class="list-group-item"\n       ng-repeat="identity in identities |\n                  filter: userFilter"\n       ng-disabled="disabled"\n       ng-click="select(identity)"\n       >\n    {{identity.first_name}} {{identity.last_name}}<span ng-if="identity.location.length > 0">, {{identity.location}}</span>\n  </div>\n  <div class="list-group-item list-group-item-warning"\n       ng-show="dissociate"\n       ng-disabled="disabled"\n       ng-click="dissociate()"\n       translate\n       translate-comment="for example, the owner of a phone number is...">\n    Unknown\n  </div>\n</div>\n'),a.put("views/main.html",""),a.put("views/mobile-queue.html",'<div queue-selection></div>\n<p>\n  <div class="input-group">\n    <div class="input-group-addon">\n      <span class="glyphicon glyphicon-search"></span>\n    </div>\n    <input class="form-control" type="search" ng-model="q" />\n  </div>\n</p>\n<div\n   ng-repeat="report in reports | filter:q"\n   report-summary\n   >\n</div>\n<div ng-show="loading">\n  <p>\n    <h5 class="text-center" translate>Loading...</h5>\n    <div class="text-center">\n      <span class="fa fa-refresh fa-spin"></span>\n    </div>\n  </p>\n</div>\n<p ng-hide="loading || reports.length" translate>\n  No reports match your search criteria\n</p>\n'),a.put("views/modals/login.html",'<div ng-controller="LoginModalCtrl">\n  <div class="modal-header">\n    <!--button type="button" class="close" ng-click="$hide()"\n        >&times;</button-->\n    <h4 class="modal-title" translate>\n      Login\n    </h4>\n  </div>\n  <div class="modal-body">\n    <div ng-messages="messages">\n      <div class="alert alert-danger" ng-message="authenticationFailure">\n        <span translate>\n          Cannot log in with these credentials\n        </span>\n      </div>\n    </div>\n    <form role="form" class="clearfix">\n      <div class="form-group">\n        <label for="username" translate>User name</label>\n        <input type="text" class="form-control" id="username"\n               placeholder="Enter name"\n               ng-model="username">\n      </div>\n      <div class="form-group">\n        <label for="password" translate>Password</label>\n        <input type="password" class="form-control" id="password"\n               placeholder="Password"\n               ng-model="password">\n      </div>\n      <button type="submit" class="btn btn-default pull-right"\n              ng-click="submit()"\n              translate>\n        Submit\n      </button>\n    </form>\n  </div>\n</div>\n'),a.put("views/modals/remove-coverage.html",'<div ng-controller="RemoveCoverageModalCtrl">\n  <div class="modal-header">\n    <h4 class="modal-title" translate>\n      Confirm coverage deletion\n    </h4>\n  </div>\n  <div class="modal-body">\n    <div ng-show="loading" class="text-center">\n      <span class="fa fa-refresh fa-spin"></span>\n    </div>\n    <div ng-hide="loading">\n      <div ng-show="disabled">\n        <p translate>\n          There are {{reports.length}} reports published under this\n          coverage, you have to unpublish those reports before\n          deleting the coverage\n        </p>\n        <p>\n          <a ng-href="#/reports-in-coverage/{{coverage.uuid}}"\n             ng-click="$dismiss()"\n             >\n            <span translate>See the published reports</span>\n          </a>\n        </p>\n      </div>\n      <div ng-hide="disabled">\n        <p translate>\n          Are you sure that you want to delete this coverage?\n        </p>\n      </div>\n    </div>\n  </div>\n  <div class="modal-footer">\n    <button type="button" class="btn btn-default"\n            ng-click="$close()"\n            ng-disabled="disabled"\n            translate>\n      Delete\n    </button>\n    <button type="button" class="btn btn-primary"\n            ng-click="$dismiss()"\n            translate>\n      Do not delete\n    </button>\n  </div>\n</div>\n'),a.put("views/monitor.html",'<div queue-selection></div>\n<p ng-if="monitor">\n  {{monitor.user_id.username}} is monitoring {{monitor.filter.spec.track|arrayToText}}\n</p>\n<div\n   ng-repeat="report in reports"\n   tweet-summary\n   >\n</div>\n'),a.put("views/my-monitor.html",'<div queue-selection></div>\n<div ng-show="monitor">\n  <form ng-hide="editing" class="form-inline">\n    <div class="form-group">\n      <button class="btn btn-default"\n              type="button"\n              ng-click="edit()"\n              ng-disabled="disabled"\n              >\n        <span class="glyphicon glyphicon-pencil"></span>\n      </button>\n      <span class="fa fa-refresh fa-spin" ng-show="updating"></span>\n    </div>\n  </form>\n  <form ng-show="editing" class="form-inline">\n    <div class="form-group">\n      <input class="form-control"\n             ng-model="search" required\n             ng-list>\n    </div>\n    <div class="form-group">\n      <button class="btn btn-default"\n              type="button"\n              ng-click="cancelEdit()"\n              ng-disabled="disabled"\n              >\n        <span class="glyphicon glyphicon-remove"></span>\n      </button>\n      <button class="btn btn-default"\n              type="button"\n              ng-click="save()"\n              ng-disabled="disabled"\n              >\n        <span class="glyphicon glyphicon-floppy-disk"></span>\n      </button>\n    </div>\n  </form>\n  <p ng-show="tellToWait">\n    <span translate>\n      Your monitored terms have been saved. Check back to this page to\n      see updates as they come in\n    </span>\n  </p>\n  <p ng-show="newReports.length" class="text-center">\n    <button type="button" class="btn btn-default" ng-click="showNew()">\n      <span translate>{{newReports.length}} new reports</span>\n    </button>\n  </p>\n  <div\n     ng-repeat="report in reports"\n     tweet-summary\n     >\n  </div>\n</div>\n<div ng-show="showCreate">\n  <h4 translate>Start your monitor</h4>\n  <form>\n    <div class="form-group">\n      <label for="createSearch" translate>\n        Search terms\n      </label>\n      <input class="form-control" id="createSearch"\n             ng-model="search" ng-list required\n             placeholder="place @user #hashtag">\n    </div>\n    <button type="submit" class="btn btn-primary" ng-click="create()"\n            ng-disabled="disabled"\n            >\n      <span translate>\n        Start monitoring\n      </span>\n    </button>\n  </form>\n</div>\n<div ng-show="showKeyPointer">\n  <h4 translate>Your Twitter key is missing</h4>\n  <p translate>\n      In order to use a personal monitor, Twitter requires an\n      application key. You can find more information and add your key\n      in the <a href="#/configure-twitter-ingestion-oauths"> key\n      configuration page </a>\n  </p>\n</div>\n'),a.put("views/new-report.html",'<form\n   class="form-horizontal"\n   ng-submit="submit()"\n   >\n  <div class="form-group">\n    <label class="col-md-2 control-label">Report content</label>\n    <div class="col-md-10">\n      <textarea class="form-control" required ng-model="content"></textarea>\n    </div>\n  </div>\n  <div class="form-group">\n    <div class="col-md-offset-2 col-md-10">\n      <button class="btn btn-default" type="submit">Submit</button>\n    </div>\n  </div>\n</form>\n'),a.put("views/new-twitter-search.html",'<h2 translate>New Twitter search</h2>\n<form class="form-horizontal">\n  <fieldset>\n    <div class="form-group left">\n      <label class="col-md-3" translate>\n        Please specify some search terms\n      </label>\n      <div class="col-md-9">\n        <input type="text" class="col-md-10 form-control" ng-model="terms">\n      </div>\n    </div>\n    <div>\n      <button class="btn btn-primary" ng-click="submit()">\n        Submit\n      </button>\n    </div>\n  </fieldset>\n</form>\n<div ng-show="loading">\n  <p>\n    <h5 class="text-center" translate>Loading...</h5>\n    <div class="text-center">\n      <span class="fa fa-refresh fa-spin"></span>\n    </div>\n  </p>\n</div>\n'),a.put("views/processed-queues.html",'<h3 ng-class="{\'text-center\': largeScreen}" translate>Processed reports</h3>\n<div class="row">\n  <div class="col-md-offset-2 col-md-8">\n    <ul class="list-group text-center">\n      <!-- !totals[group.key] collapses when the totals are 0 or when\n      the totals are not fetched yet. this avoids showing danger\n      elements when we are still fetching the data -->\n      <div\n         ng-repeat="group in groups"\n         collapse="collapseEmpty && (!totals[group.key])"\n         >\n         <a class="list-group-item"\n            ng-class="group.class"\n            ng-href="#/generic-report-list/{{group.key}}">\n           <span ng-bind="group.description"></span>\n           <span class="badge" ng-bind="totals[group.key]"></span>\n         </a>\n      </div>\n    </ul>\n  </div>\n  <div class="col-md-offset-2 col-md-8">\n    <p>\n      <div class="checkbox">\n        <label>\n          <input type="checkbox" ng-model="collapseEmpty">\n          <span translate>\n            Collapse empty groups\n          </span>\n        </label>\n      </div>\n    </p>\n  </div>\n</div>\n'),a.put("views/queues.html",'<h3 translate>\n  Incoming Reports\n</h3>\n<div class="list-group">\n  <div>\n    <a class="list-group-item list-group-item-info"\n       ng-href="#/mobile-queue">\n      <span class="glyphicon glyphicon-phone pull-right"></span>\n      <span translate>Mobile reports</span>\n    </a>\n  </div>\n  <div>\n    <a class="list-group-item list-group-item-info"\n       ng-href="#/list-from-the-web">\n      <span class="glyphicon glyphicon-globe pull-right"></span>\n      <span translate>Content from the Web</span>\n    </a>\n  </div>\n</div>\n<h4>\n  <span translate>Tweets</span>\n  <a href="#/help-tweet-queues">\n    <small>\n      <span class="glyphicon glyphicon-question-sign"></span>\n    </small>\n  </a>\n</h4>\n<div class="list-group">\n  <div ng-repeat="queue in monitors">\n    <a class="list-group-item list-group-item-success"\n       ng-href="#/monitor/{{queue._id}}"\n       ng-show="queue.user_id._id != session.identity._id">\n      <span translate>\n        {{queue.user_id.username}}\'s monitor\n      </span>\n      <span class="badge" ng-bind="queue.reports.length"></span>\n    </a>\n  </div>\n  <div>\n    <a class="list-group-item list-group-item-success" ng-href="#/my-monitor">\n      <span class="glyphicon glyphicon-eye-open pull-right"></span>\n      <span translate>\n        Your monitor\n      </span>\n      <span class="badge" ng-bind="myMonitor.reports.length"></span>\n    </a>\n  </div>\n  <div>\n    <a class="list-group-item list-group-item-warning"\n       ng-href="#/new-twitter-search">\n      <span translate>New Twitter search</span>\n    </a>\n  </div>\n  <div>\n    <a class="list-group-item list-group-item-warning"\n       ng-show="searches.length"\n       ng-click="collapseSearches = !collapseSearches">\n      <span class="glyphicon glyphicon-chevron-down pull-right"></span>\n      <span ng-switch="collapseSearches">\n        <span ng-switch-when="true">\n          <span translate>Show Twitter searches</span>\n        </span>\n        <span ng-switch-default>\n          <span translate>Hide Twitter searches</span>\n        </span>\n      </span>\n    </a>\n  </div>\n  <div collapse="collapseSearches">\n    <a ng-repeat="queue in searches" class="list-group-item"\n       ng-href="#/twitter-search/{{queue._id}}"\n       >\n      <span ng-bind="queue.description"></span>\n      <span class="badge" ng-bind="queue.reports.length"></span>\n    </a>\n  </div>\n  <div>\n    <a class="list-group-item list-group-item-warning"\n       ng-href="#/twitter-search/{{searches[searches.length - 1]._id}}">\n      <span translate>Most recent search: {{searches[searches.length - 1].description}} <span class="badge pull-right"></span></span>\n    </a>\n  </div>\n  <!--div class="list-group-item">\n      <a ng-href="#/web-queue">\n        <span>From the web</span>\n      </a>\n  </div-->\n</div>\n<div class="list-group">\n  <a class="list-group-item" ng-href="#/processed-queues">\n    <span class="glyphicon glyphicon-list-alt pull-right"></span>\n    <span translate>Processed reports</span>\n  </a>\n</div>\n'),a.put("views/report-sms.html",'<h3 translate>Report details</h3>\n<div class="panel panel-info">\n  <div class="panel-heading" translate>\n    Text\n  </div>\n  <div class="panel-body break-long-words">\n    <div ng-show="editingTranscript" class="form-group">\n      <textarea ng-model="transcriptCandidate" class="form-control"\n                rows="5"\n                ></textarea>\n      <button type="button" class="btn btn-default btn-sm" translate\n              ng-click="saveTranscript()"\n              ng-disabled="disableTranscript"\n              >\n        Save\n      </button>\n      <button type="button" class="btn btn-default btn-sm" translate\n              ng-click="cancelTranscriptEditing()"\n              ng-disabled="disableTranscript"\n              >\n        Cancel\n      </button>\n    </div>\n    <div ng-show="hasTranscript && !editingTranscript">\n      <p\n         class="lead"\n         id="text"\n         ng-bind="report.texts[0].transcript"\n         ></p>\n      <button type="button" class="btn btn-default btn-sm" translate\n              ng-click="startTranscript()"\n              >\n        Edit\n      </button>\n      <button type="button" class="btn btn-default btn-sm" translate\n              ng-click="discardTranscript()"\n              >\n        Discard\n      </button>\n      <hr>\n    </div>\n    <h5 ng-show="hasTranscript || editingTranscript" translate>\n      Original text:\n    </h5>\n    <p\n       id="text"\n       ng-bind="report.texts[0].original"\n       ng-class="{lead: !hasTranscript}"\n       ></p>\n    <button type="button" class="btn btn-default btn-sm" translate\n            ng-click="startTranscript()"\n            ng-hide="hasTranscript || editingTranscript"\n            >\n      Edit\n    </button>\n  </div>\n</div>\n<p ng-show="report.feed_type==\'sms\'">\n  <a class="btn btn-default"\n     ng-href="#/session/{{encodedSession}}"\n     >\n    <span class="fa fa-comments-o"></span>\n    <span translate>Session</span>\n  </a>\n</p>\n<div>\n  <div class="row">\n    <div class="col-sm-6">\n      <dl>\n        <dt translate>Author</dt>\n        <dd>\n          <report-author author="report.authors[0]">\n        </dd>\n      </dl>\n      <dl>\n        <dt translate>Created</dt>\n        <dd ng-bind="report.produced | date:\'medium\'"></dd>\n      </dl>\n      <dl ng-repeat="url in report.original.entities.urls">\n        <dt translate>External link</dt>\n        <dd>\n          <a target="_blank" ng-href="{{url.url}}"\n             ng-bind="url.display_url">\n          </a>\n        </dd>\n      </dl>\n    </div>\n  </div>\n</div>\n<div common-report-detail-part></div>\n<div ng-if="report.summary">\n  <h4 translate>Session summary</h4>\n  <p translate>\n    This report was generated as the summary of a session, so you\n    can perform specific actions like deleting this summary\n  </p>\n  <p>\n    <a ng-href="#/session/{{report.session}}">\n      <span translate>Go to the corresponding session</span>\n    </a>\n  </p>\n  <p ng-show="isPublished">\n    <span translate>\n      The summary cannot be deleted as long as it is published\n    </span>\n  </p>\n  <p ng-hide="isPublished">\n    <button class="btn btn-danger" ng-click="deleteSummary()"\n            ng-disabled="deleteSummaryDisabled">\n      <span translate>Delete this summary</span>\n    </button>\n  </p>\n</div>\n<p>&nbsp;</p>\n<div class="clearfix"></div>\n'),a.put("views/report-tweet.html",'<h3 translate>Report details</h3>\n<div class="panel panel-info">\n  <div class="panel-heading" translate>\n    Tweet\n  </div>\n  <div class="panel-body break-long-words">\n    <!-- upper part of the tweet -->\n    <div class="row">\n      <!-- avatar -->\n      <div class="col-md-2 col-xs-3">\n        <a target="_blank"\n           ng-href="//twitter.com/{{report.original.user.screen_name}}">\n          <img class="media-object"\n               ng-src="{{report.original.user.profile_image_url_https}}">\n        </a>\n      </div>\n      <div class="col-md-8 col-xs-7">\n        <!-- full name -->\n        <div>\n          <a target="_blank"\n             ng-href="//twitter.com/{{report.original.user.screen_name}}">\n            <strong ng-bind="report.original.user.name"></strong>\n          </a>\n        </div>\n        <!-- Twitter user name -->\n        <div>\n          <a target="_blank"\n             ng-href="//twitter.com/{{report.original.user.screen_name}}">\n            <span ng-bind="\'@\'+report.original.user.screen_name"\n                  class="text-muted">\n            </span>\n          </a>\n        </div>\n      </div>\n      <!-- logo button -->\n      <div class="col-md-2 col-xs-2">\n        <a href="https://twitter.com" target="_blank" class="pull-right">\n          <img src="https://g.twimg.com/dev/sites/default/files/images_documentation/bird_blue_16.png"\n               width="14" height="11">\n        </a>\n      </div>\n    </div>\n    <!-- middle part of the tweet -->\n    <p id="text"\n       ng-bind-html="linkedText"\n       ng-class="lead"\n       >\n    </p>\n    <!-- lower part of the tweet -->\n    <div class="pull-right">\n      <a ng-href="https://twitter.com/intent/favorite?tweet_id={{report.original.id_str}}"\n         target="_blank">\n        <img\n           src="//si0.twimg.com/images/dev/cms/intents/icons/favorite.png">\n      </a>\n      <a ng-href="https://twitter.com/intent/tweet?in_reply_to={{report.original.id_str}}"\n         target="_blank">\n        <img\n           src="//si0.twimg.com/images/dev/cms/intents/icons/reply.png">\n      </a>\n      <a ng-href="https://twitter.com/intent/retweet?tweet_id={{report.original.id_str}}"\n         target="_blank">\n        <img\n           src="//si0.twimg.com/images/dev/cms/intents/icons/retweet.png">\n      </a>\n    </div>\n    <span ng-bind="report.produced | date:\'medium\'" class="text-muted">\n    </span>\n  </div>\n</div>\n<div class="panel panel-info"\n     ng-repeat="medium in report.original.entities.media">\n  <div class="panel-heading" translate>\n    Media\n  </div>\n  <div class="panel-body">\n    <img class="img-responsive center-block" ng-src="{{medium.media_url_https}}">\n  </div>\n  <div class="panel-footer text-center">\n    <a target="_blank"\n       class="btn btn-default"\n       ng-href="http://regex.info/exif.cgi?imgurl={{medium.media_url_https}}"\n       >\n      Jeffrey\'s Exif Viewer\n    </a>\n    <a target="_blank"\n       ng-href="http://www.google.com/searchbyimage?image_url={{medium.media_url_https}}"\n       class="btn btn-default"\n       >\n      <span translate>Reverse Image Search</span>\n    </a>\n    <a target="_blank"\n       ng-href="http://fotoforensics.com/upload-url.php?url={{medium.media_url_https}}"\n       class="btn btn-default"\n       >\n      <span translate>Error level</span>\n    </a>\n  </div>\n</div>\n<p ng-show="report.feed_type==\'sms\'">\n  <!--a class="btn btn-primary"\n      ng-href="#/session/{{encodedSession}}/{{report._id}}"\n      translate\n      >\n      Reply\n      </a-->\n  <a class="btn btn-default"\n     ng-href="#/session/{{encodedSession}}"\n     translate\n     >\n    Session\n  </a>\n</p>\n<div>\n  <div class="row">\n    <div class="col-sm-6">\n      <dl>\n        <dt translate>Citizen card</dt>\n        <dd>\n          <a ng-bind="report.authors[0].identifiers.user_name"\n             ng-href="#/citizen-card/{{report.authors[0].authority}}/{{report.authors[0].identifiers.user_name}}"\n             ></a>\n        </dd>\n      </dl>\n    </div>\n  </div>\n</div>\n<div common-report-detail-part></div>\n'),a.put("views/report-web-link.html",'<h3 translate>Report details</h3>\n<div class="panel panel-info">\n  <div class="panel-heading">\n    <a ng-bind="report.texts[0].original"\n       ng-href="{{report.original.url}}"\n       target="_blank">\n    </a>\n  </div>\n  <div class="panel-body break-long-words">\n    <p\n       id="text lead"\n       ng-bind="report.texts[1].original"\n       ></p>\n  </div>\n</div>\n<div class="panel panel-info"\n     ng-if="report.media.length">\n  <div class="panel-heading" translate>\n    Media\n  </div>\n  <div class="panel-body">\n    <img class="img-responsive" ng-src="{{report.media[0].link}}">\n  </div>\n  <div class="panel-footer">\n    <button class="btn btn-default" ng-click="toMediaSelection()">\n      <span translate>\n        Select the published image\n      </span>\n    </button>\n  </div>\n</div>\n<div>\n  <dl class="dl-horizontal">\n    <dt translate>Original link</dt>\n    <dd>\n      <a ng-bind="report.original.url"\n         ng-href="{{report.original.url}}"\n         target="_blank"\n         ></a>\n    </dd>\n    <dt translate>Citizen card</dt>\n    <dd>\n      <a ng-bind="report.authors[0].identifiers.user_name"\n         ng-href="#/citizen-card/{{report.authors[0].authority}}/{{report.authors[0].identifiers.user_name}}"\n         ></a>\n    </dd>\n  </dl>\n</div>\n<div common-report-detail-part></div>\n'),a.put("views/select-media-to-publish.html",'<h4 translate>\n  Please select the image you want to be published with this report\n</h4>\n<form ng-submit="submit()">\n  <div class="checkbox" ng-repeat="image in report.media">\n    <label>\n      <input type="radio" ng-model="$parent.selected" ng-value="$index">\n      <strong translate>Image {{$index+1}}</strong>\n      <p></p>\n      <p>\n        <img ng-src="{{image.link}}" class="img-thumbnail">\n      </p>\n    </label>\n  </div>\n  <button class="btn btn-default" ng-click="cancel()">\n    <span translate>Cancel</span>\n  </button>\n  <button type="sumbit" class="btn btn-primary" ng-disabled="disabled">\n    <span translate>Save selection</span>\n  </button>\n</form>\n'),a.put("views/session.html",'<h3 translate>Mobile session</h3>\n<div ng-repeat="report in reports">\n  <div class="row">\n    <div ng-show="report.authors[0].identifiers.user_id == identity.user"\n         class="col-md-9 col-md-offset-3">\n      <div class="panel panel-info">\n        <div class="panel-heading">\n          <small class="pull-right" ng-bind="report.produced | date:\'medium\'">\n          </small>\n          <!-- since fetching details about the actual sender happens\n              asynchronously, the markup must support the lack of\n              details -->\n          <span ng-if="report.local">\n            <span ng-if="users[report.user_id]">\n              <span ng-bind="users[report.user_id].username">\n              </span>\n            </span>\n            <span ng-if="!users[report.user_id]">\n              <span translate>\n                Sent by Citizen Desk\n              </span>\n            </span>\n          </span>\n          <span ng-if="!report.local">\n            <span ng-repeat="author in report.authors"\n                  ng-bind="author.identifiers.user_name">\n            </span>\n          </span>\n        </div>\n        <div class="panel-body" ng-bind="report.texts[0].original">\n        </div>\n      </div>\n    </div>\n    <div ng-hide="report.authors[0].identifiers.user_id == identity.user"\n         class="col-md-9">\n      <div class="panel panel-primary">\n        <div class="panel-heading">\n          <small class="pull-right" ng-bind="report.produced | date:\'medium\'">\n          </small>\n          <span ng-bind="report.authors[0].identifiers.user_name">\n          </span>\n        </div>\n        <div class="panel-body" ng-bind="report.texts[0].original">\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n<tabset>\n  <tab>\n    <tab-heading>\n      <span translate>Reply</span>\n    </tab-heading>\n    <p>\n      <form>\n        <div class="form-group">\n          <label translate>\n            Reply to {{replyReport.authors[0].identifiers.user_name}}\n          </label>\n          <textarea class="form-control" rows="3" ng-model="$parent.reply">\n          </textarea>\n          <p class="help-block" translate>\n            Still {{140 - reply.length}} characters in order to fit in\n            a single SMS\n          </p>\n        </div>\n        <button class="btn btn-primary" translate\n                ng-click="sendReply()"\n                type="submit">\n          Send\n        </button>\n        <button class="btn btn-default" translate\n                ng-click="reset()">\n          Reset\n        </button>\n        <div class="checkbox">\n          <label>\n            <input type="checkbox" ng-model="body.glue">\n            <span translate>Stick to the bottom</span>\n          </label>\n        </div>\n      </form>\n    </p>\n  </tab>\n  <tab>\n    <tab-heading>\n      <span translate>Summary</span>\n    </tab-heading>\n    <p>\n      <form>\n        <div class="form-group">\n          <label>Session summary:</label>\n          <div ng-hide="summaries.length">\n            <textarea class="form-control" ng-model="$parent.summaryContent"\n                      required\n                      rows="3">\n            </textarea>\n          </div>\n          <div ng-show="summaries.length">\n            <textarea class="form-control"\n                      ng-model="summaries[0].texts[0].original"\n                      rows="3" disabled>\n            </textarea>\n          </div>\n        </div>\n        <button class="btn btn-primary" ng-click="submitSummary()"\n                ng-if="!summaries.length">\n          <span translate>\n            Create a session summary\n          </span>\n        </button>\n        <button class="btn btn-primary" ng-click="goToSummary()"\n                ng-if="summaries.length">\n          <span translate>\n            See summary details\n          </span>\n        </button>\n        <div class="checkbox">\n          <label>\n            <input type="checkbox" ng-model="body.glue">\n            <span translate>Stick to the bottom</span>\n          </label>\n        </div>\n      </form>\n    </p>\n  </tab>\n</tabset>\n'),a.put("views/simple-report-list.html",'<h3 ng-bind="description"></h3>\n<p>\n  <div class="input-group">\n    <div class="input-group-addon">\n      <span class="glyphicon glyphicon-search"></span>\n    </div>\n    <input class="form-control" type="search" ng-model="q" />\n  </div>\n</p>\n<div\n   ng-repeat="report in reports | filter:q"\n   ng-switch on="report.feed_type"\n   >\n  <div ng-switch-when="tweet" tweet-summary></div>\n  <div ng-switch-default      report-summary></div>\n</div>\n<div ng-show="loading">\n  <p>\n    <h5 class="text-center" translate>Loading...</h5>\n    <div class="text-center">\n      <span class="fa fa-refresh fa-spin"></span>\n    </div>\n  </p>\n</div>\n<div ng-hide="loading || reports.length" translate>\n  No reports in this queue\n</div>\n'),a.put("views/twitter-search.html",'<div queue-selection></div>\n<div>\n  <p ng-switch="status" class="clearfix">\n    <a href="https://twitter.com" target="_blank">\n      <img src="https://g.twimg.com/dev/sites/default/files/images_documentation/bird_blue_16.png"\n           width="14" height="11">\n    </a>\n    <span class="pull-right">\n      <button class="btn btn-warning btn-xs pull-right"\n              ng-switch-when="deleted"\n              disabled\n              >\n        <span translate>Deleted</span>\n      </button>\n      <span\n         ng-switch-when="error"\n         >\n        <span translate>Error deleting</span>\n        <button class="btn btn-warning btn-xs"\n                ng-click="delete()"\n                >\n          <span translate>Try again</span>\n        </button>\n      </span>\n      <button class="btn btn-warning btn-xs"\n              ng-switch-when="deleting"\n              disabled\n              >\n        <span class="fa fa-refresh fa-spin"></span>\n        <span translate>Deleting</span>\n      </button>\n      <button class="btn btn-warning btn-xs"\n              ng-switch-default\n              ng-click="delete()"\n              ng-disabled="!queue"\n              >\n        <span class="glyphicon glyphicon-trash"></span>\n        <span translate>Delete search</span>\n      </button>\n    </span>\n  </p>\n</div>\n<p>\n  <div class="input-group">\n    <div class="input-group-addon">\n      <span class="glyphicon glyphicon-search"></span>\n    </div>\n    <input class="form-control" type="search" ng-model="q" />\n  </div>\n</p>\n<div\n   ng-repeat="report in queue.reports | filter:q | limitTo:queue.limit"\n   tweet-summary\n   >\n</div>\n<p ng-show="queue.reports.length > queue.limit">\n  <button class="btn btn-default btn-lg btn-block"\n          ng-click="queue.limit = queue.limit + 50"\n          >\n    <span translate>\n      See more reports\n    </span>\n  </button>\n</p>\n<div ng-show="loading">\n  <p>\n    <h5 class="text-center" translate>Loading...</h5>\n    <div class="text-center">\n      <span class="fa fa-refresh fa-spin"></span>\n    </div>\n  </p>\n</div>\n<p ng-hide="loading || queue.reports.length" translate>\n  No reports match your search criteria\n</p>\n'),a.put("views/verified-reports.html",'<ol class="breadcrumb">\n  <li class="active" translate>Verified reports</li>\n</ol>\n<div\n   ng-repeat="report in reports"\n   report-summary\n   >\n</div>\n<p ng-hide="reports.length" translate>\n  There are no verified reports yet\n</p>\n')
}]),angular.module("citizendeskFrontendApp").controller("AssignedToMeCtrl",["$scope","api","session","Report","lodash","AliasesInLists","allPages",function(a,b,c,d,e,f,g){a.reports=[],a.disabled={},a.loading=!0,g(function(g){return b.reports.query({where:JSON.stringify({$and:[{"assignments.user_id":c.identity._id},{$or:[{status:""},{status:{$exists:!0}},{"coverages.published":{$size:1}}]}]}),page:g,sort:'[("produced", -1)]'}).then(function(b){var c=[];return e.forEach(b._items,function(b){b.published=b.coverages.published.length>0,""===b.status&&(b.status="tbd"),a.reports.push(b),console.log("push into $scope.reports successful")}),d.linkTweetTextsInList(c),a.reports.map(f.embedAuthorAlias),a.reports=a.reports.concat(c),b})}).then(function(){a.loading=!1}),a.filterOptArr=[{value:"newest",text:"Newest"},{value:"active",text:"Most Active"}],a.typeOptArr=[{value:0,text:"All"},{value:"tweet",text:"Tweet"},{value:"sms",text:"SMS"},{value:"other",text:"Other"}],a.verOptArr=[{value:0,text:"All"},{value:"verified",text:"Verified"},{value:"debunked",text:"Debunked"},{value:"tbd",text:"Unverified"}],a.pubOptArr=[{value:"",text:"All"},{value:{published:!0},text:"Published"},{value:{published:!1},text:"Not Published"}],a.dismiss=d.getDismiss(a.disabled,function(b){e.remove(a.reports,function(a){return a._id===b._id})})}]),angular.module("citizendeskFrontendApp").controller("AssignedCtrl",["$scope","Assign",function(a,b){a.users=b.users,a.totals=b.totals,a.collapseReports=!0,a.collapseTweets=!0,b.updateTotals()}]),angular.module("citizendeskFrontendApp").service("Coverages",["api","$q",function(a,b){var c=b.defer();this.promise=c.promise,a.coverages.query().then(function(a){c.resolve(a._items)})}]),angular.module("citizendeskFrontendApp").service("Report",["api","session","$q","config","$http","gettextCatalog","$window","linkTweetEntities","Raven","reportStatuses","superdeskDate",function(a,b,c,d,e,f,g,h,i,j,k){this.linkTweetTexts=function(a){if("tweet"===a.feed_type)try{a.linkedText=h(a)}catch(b){i.raven.captureException(b)}},this.linkTweetTextsInList=function(a){a.forEach(this.linkTweetTexts)},this.getDismiss=function(b,c){return function(d){return b[d._id]=!0,a.reports.update(d,{assignments:[],status:j("dismissed"),status_updated:k.render(new Date)}).then(function(a){b[d._id]=!1,c(a)})}},this.create=function(a){return{texts:[],summary:!1,session:a.session,channels:[{type:"frontend"}],produced:k.render(new Date),user_id:b._id,authors:[{authority:"citizen_desk",identifiers:{user_name:b.identity._id,user_name_search:b.identity._id,user_display_name:b.identity.username}}],assignments:[],feed_type:"plain",automatic:!1,local:!0,proto:!1,notices_outer:[]}}}]),angular.module("citizendeskFrontendApp").service("Body",["$rootScope",function(a){var b=this;this.glue=!1,a.$on("$routeChangeStart",function(){b.glue=!1}),this.connectionError=null}]),angular.module("citizendeskFrontendApp").controller("BodyCtrl",["$scope","Body","screenSize","$window",function(a,b,c,d){a.service=b,a.navCollapsed=!0,a.clickNavigation=function(){c.is("xs")&&(a.navCollapsed=!0)},a.reload=function(){d.location.reload()}}]),angular.module("citizendeskFrontendApp").controller("MyMonitorCtrl",["$scope","api","$http","Monitors","session","Raven","config","addNewValues","dateFetcherFactory","PagePolling","QueueSelection","$filter","linkTweetEntities","PageBroker","AliasesInLists","$timeout",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a){try{a.linkedText=m(a)}catch(b){f.raven.captureException(b)}o.embedAuthorAlias(a)}function r(c){return b.reports.query({page:c,sort:'[("produced", -1)]',embedded:'{"assignments.user_id": 1}',where:JSON.stringify({"channels.value":a.monitor._id})})}function s(){a.page=1,r(a.page).then(function(c){a.reports=c._items,a.reports.forEach(q);var d=i({endpoint:b.reports,property:"produced",initialise:a.reports});j.setInterval(function(){a.updating=!0,d.queryWhere({"channels.value":a.monitor._id}).then(function(b){a.updating=!1,b._items.forEach(q),h(a.newReports,b._items)})},1e4)})}function t(){p.cancel(u),a.tellToWait=!0,u=p(function(){a.tellToWait=!1},1e4)}a.missing={monitor:!1,key:!1},a.disabled=!1,a.editing=!1,a.newReports=[],a.search=[],a.missingChange=function(){var b=a.missing;a.showKeyPointer=b.monitor&&b.key,a.showCreate=b.monitor&&!b.key,b.key&&!b.monitor&&f.raven.captureMessage("This user has no keys but she has a running monitor!",{extra:{name:e.identity.username}})},a.monitorChange=function(){if(a.monitor){var b=a.monitor.filter.spec.track;a.search=b,k.description=b.join(", ")}},a.$watch("missing",a.missingChange,!0),a.$watch("monitor",a.monitorChange,!0);var u,v={start:function(a){return c.get(g.server.url+"/proxy/start-stream/"+a._id)},stop:function(a){return c.get(g.server.url+"/proxy/stop-stream/"+a._id)}};a.moreReports=function(){a.page+=1,r(a.page).then(function(b){h(a.reports,b._items)})},a.showNew=function(){h(a.reports,a.newReports),a.reports=l("sortByDate")(a.reports,"produced",!0),a.newReports=[]},d.getByUserId(e.identity._id).then(function(b){b?(a.monitor=b,s()):a.missing.monitor=!0}),b.twt_oauths.query({where:JSON.stringify({user_id:e.identity._id})}).then(function(b){var c=b._items.pop();c?a.key=c:a.missing.key=!0}),a.create=function(){var c,f={spec:{track:a.search}};a.disabled=!0,b.twt_filters.save(f).then(function(d){c=d,a.filter=c;var f={user_id:e.identity._id,spec:{filter_id:c._id,oauth_id:a.key._id}};return b.twt_streams.save(f)}).then(function(b){return a.monitor=b,a.monitor.filter=c,delete a.missing.monitor,a.disabled=!1,d.update(),v.start(b)}).then(function(){t(),s()})},a.edit=function(){a.editing=!0},a.cancelEdit=function(){a.editing=!1},a.save=function(){var c=angular.copy(a.monitor.filter);c.spec.track=a.search,b.twt_filters.save(c).then(function(b){return a.monitor.filter=b,v.stop(a.monitor)}).then(function(){return v.start(a.monitor)}).then(function(){a.editing=!1,t(),s()})},a.assign=function(a){n.load("/assign/",{report:a})}}]),angular.module("citizendeskFrontendApp").factory("dateFetcherFactory",["superdeskDate","lodash",function(a,b){var c=b;return function(b){var d={date:null,onResponse:function(a){return d.update(a._items),a},update:function(d){var e=[];if(d.forEach(function(c){var d=c[b.property];if(d){var f=a.parse(d);e.push(f)}}),e.length){var f=c.max(e);this.date=a.render(f)}},queryWhere:function(a){var c=this,d={};c.date&&(d={},d[b.property]={$gt:c.date});var e={where:JSON.stringify({$and:[a,d]})};return b.endpoint.query(e).then(c.onResponse)}};return d.update(b.initialise),d}}]),angular.module("citizendeskFrontendApp").factory("superdeskDate",function(){function a(a){var b=String(a);return 1===b.length?"0"+b:b}return{render:function(b){if(b instanceof Date){var c=b.getUTCFullYear(),d=a(b.getUTCMonth()+1),e=a(b.getUTCDate()),f=a(b.getUTCHours()),g=a(b.getUTCMinutes()),h=a(b.getUTCSeconds()),i=c+"-"+d+"-"+e,j=f+":"+g+":"+h+"+0000";return i+"T"+j}var k=JSON.stringify(b);throw Error("superdeskDate parsing "+k)},parse:function(a){function b(a){return parseInt(a,10)}var c=a.split("T"),d=c[0],e=c[1],f=d.split("-"),g=e.split("+"),h=g[0],i=h.split(":");if("0000"!==g[1])throw new Error("Date "+a+" is probably not in UTC time, or not in the expected format");f=f.map(b),i=i.map(b);var j=f[0],k=f[1]-1,l=f[2],m=i[0],n=i[1],o=i[2],p=Date.UTC(j,k,l,m,n,o);return new Date(p)}}}),angular.module("citizendeskFrontendApp").factory("linkTweetEntities",function(){function a(a,b,c,d){var e=a.slice(0,c),f=a.slice(d);return e+b+f}function b(b,c){return c.sort(function(a,b){return b.indices[0]-a.indices[0]}),c.forEach(function(c){b=a(b,c.text,c.indices[0],c.indices[1])}),b}function c(a){return'<a href="'+a.reference+'" target="_blank">'+a.text+"</a>"}function d(a,b){switch(a){case"user_mentions":return{text:"@"+b.screen_name,reference:"https://twitter.com/"+b.screen_name};case"hashtags":return{text:"#"+b.text,reference:"https://twitter.com/search?q=%23"+b.text};case"urls":return{text:b.display_url,reference:b.url}}}function e(a){var e=["user_mentions","hashtags","urls"],f=[];return e.forEach(function(b){a.original.entities[b].forEach(function(a){var e={text:c(d(b,a)),indices:a.indices};f.push(e)})}),b(a.original.text,f)}return e.patch=a,e.patchAll=b,e.anchorify=c,e.reference=d,e}),angular.module("citizendeskFrontendApp").directive("tweetSummary",function(){return{templateUrl:"views/directives/tweet-summary.html"}}),angular.module("citizendeskFrontendApp").controller("ConfigureCoveragesCtrl",["$scope","api","lodash","$modal","$rootScope",function(a,b,c,d,e){function f(b){return a.disabled=!0,b.then(function(){a.disabled=!1})}b.coverages.query().then(function(b){a.coverages=b._items}),a.save=function(c){f(b.coverages.save(c).then(function(){a.disabled=!1}))},a.remove=function(g){var h=e.$new();h.coverage=angular.copy(g);var i=d.open({templateUrl:"views/modals/remove-coverage.html",scope:h});i.result.then(function(){f(b.coverages.remove(g).then(function(){c.remove(a.coverages,function(a){return a._id===g._id})}))})},a.add=function(){a.coverages.push({})}}]),angular.module("citizendeskFrontendApp").factory("Bacon",function(){return Bacon}),angular.module("citizendeskFrontendApp").service("CitizenLists",["api",function(a){this.update=function(){return a.citizen_lists.query()},this.promise=this.update()}]),angular.module("citizendeskFrontendApp").service("AliasesInLists",["api","Raven",function(a,b){var c=this,d={where:JSON.stringify({tags:{$elemMatch:{$exists:!0}}}),embedded:'{"tags":1, "identity_record_id":1}'};this.update=function(){c.indexPromise=a.citizen_aliases.query(d).then(function(a){var b=c.createIndex(a);return b})},this.createIndex=function(a){var b={};return a._items.forEach(function(a){var c=a.authority,d=a.identifiers.user_name,e=b[c]||{};e[d]=a,b[c]=e}),b},this.embedAuthorAlias=function(a){try{a.authors.forEach(function(a){if(a.identifiers){var b=a.authority,d=a.identifiers.user_name;c.indexPromise.then(function(c){c[b]&&c[b][d]&&(a.alias=c[b][d])})}})}catch(d){b.raven.captureException(d,{extra:{report_id:a._id}})}},this.update()}]),angular.module("citizendeskFrontendApp").controller("ConfigureListsSpecificCtrl",["$scope","$window","PageBroker","api","gettextCatalog",function(a,b,c,d,e){function f(b){return d.citizen_aliases.query({where:JSON.stringify({tags:b._id})}).then(function(b){var c=b._items;return a.deletable=0===c.length,c})}function g(){var c="This citizen list is not empty and thus it cannot be deleted",d=e.getString(c);b.alert(d),a.back()}c.getData("/configure-lists/").then(function(b){"new"===b?(a.newList=!0,a.list={variation:"label-default"}):(a.list=b,f(b).then(function(b){a.aliases=b}))}),a.back=function(){b.history.back()},a.save=function(){a.disabled=!0,d.citizen_lists.save(a.list).then(function(){a.disabled=!1,a.back()})},a.delete=function(){a.disabled=!0,f(a.list).then(function(){a.deletable?d.citizen_lists.remove(a.list).then(function(){a.back()}):g()})},a.variations=["default","primary","success","info","warning","danger"].map(function(a){return{name:a,"class":"label-"+a}})}]),angular.module("citizendeskFrontendApp").controller("ConfigureListsCtrl",["$scope","api","PageBroker",function(a,b,c){b.citizen_lists.query().then(function(b){a.lists=b._items}),a.edit=function(a){c.load("/configure-lists-specific",a)},a.create=function(){c.load("/configure-lists-specific","new")}}]),angular.module("citizendeskFrontendApp").controller("EditUserListsCtrl",["$scope","api","PageBroker","$window","AliasesInLists",function(a,b,c,d,e){c.getData("/").then(function(b){a.alias=b;var c=b.tags[0];a.currentList=c?c._id:!1}),b.citizen_lists.query().then(function(b){b._items.length?a.lists=b._items:a.noLists=!0}),a.save=function(){a.disabled=!0,a.alias.tags=a.currentList?[a.currentList]:[];var c=angular.copy(a.alias);c.identity_record_id&&(c.identity_record_id=c.identity_record_id._id),b.citizen_aliases.save(c).then(function(){d.history.back(),e.update()})}}]),angular.module("citizendeskFrontendApp").factory("reportStatuses",["setFactory",function(a){return a(["debunked","verified","dismissed",""])}]),angular.module("citizendeskFrontendApp").factory("setFactory",["lodash",function(a){return function(b){return function(c){if(a.contains(b,c))return c;var d=JSON.stringify,e=d(c)+" is not in "+d(b);throw Error(e)}}}]),angular.module("citizendeskFrontendApp").directive("commonReportDetailPart",function(){return{templateUrl:"views/directives/common-report-detail-part.html"}}),angular.module("citizendeskFrontendApp").service("SimpleReportList",["api","Report","PageBroker","allPages",function(a,b,c,d){this.init=function(e,f,g){var h={};return g&&g.parameters&&(h=g.parameters),e.assign=function(a){c.load("/assign/",{report:a})},e.reports=[],h.where=JSON.stringify(f),h.sort='[("produced", -1)]',h.embedded='{"assignments.user_id": true}',d(function(c){return e.loading=!0,h.page=c,a.reports.query(h).then(function(a){return b.linkTweetTextsInList(a._items),e.reports=e.reports.concat(a._items),a})}).then(function(){e.loading=!1})}}]),angular.module("citizendeskFrontendApp").directive("reportSummaryButtons",function(){return{templateUrl:"views/directives/report-summary-buttons.html"}}),angular.module("citizendeskFrontendApp").controller("ConfigureStatusPresentationCtrl",["$scope","api","lodash",function(a,b,c){b.report_statuses.query().then(function(b){a.statuses=b._items,c.remove(a.statuses,function(a){return!a.key})}),a.save=function(c){a.disabled=!0,b.report_statuses.save(c).then(function(){a.disabled=!1})}}]),angular.module("citizendeskFrontendApp").filter("arrayToText",function(){return function(a){return a.join(", ")}}),angular.module("citizendeskFrontendApp").service("SavedQueries",["reportStatuses",function(a){function b(){return{"coverages.published":{$elemMatch:{$exists:!0}}}}function c(){return{$and:[{"assignments.user_id":{$exists:!0}},{$or:[{status:""},{status:{$exists:!1}}]}]}}function d(){return{$or:[{"coverages.published":{$size:0}},{"coverages.published":{$exists:!1}}]}}var e={where:{}};e.where.assigned=c(),e.where.not_published_assigned={$and:[c(),d()]},e.where.published_assigned={$and:[c(),b()]},e.where.dismissed={status:a("dismissed")},e.where.debunked={status:a("debunked")},e.where.published=b(),e.where.published_debunked={$and:[b(),{status:a("debunked")}]},e.where.not_published_debunked={$and:[d(),{status:a("debunked")}]},e.where.not_published_verified={$and:[d(),{status:a("verified")}]},e.where.published_verified={$and:[b(),{status:a("verified")}]},e.where.published_dismissed={$and:[b(),{status:a("dismissed")}]},e.where.not_published_dismissed={$and:[d(),{status:a("dismissed")}]},this.getWhere=function(a){if(a in e.where)return e.where[a];throw Error('"'+a+'" is not a saved where query')},this.parametric={publishedIn:function(a){return{"coverages.published":a}}}}]),angular.module("citizendeskFrontendApp").controller("ProcessedQueuesCtrl",["$scope","ProcessedQueues","gettextCatalog","screenSize",function(a,b,c,d){a.collapseEmpty=!0,a.largeScreen=d.is("md,lg"),a.groups=[{key:"published_debunked",description:c.getString("Published but debunked!"),"class":"list-group-item-danger"},{key:"published_dismissed",description:c.getString("Published but dismissed!"),"class":"list-group-item-danger"},{key:"not_published_verified",description:c.getString("Verified but not published yet"),"class":"list-group-item-warning"},{key:"published_assigned",description:c.getString("Published and still assigned"),"class":"list-group-item-warning"},{key:"published_verified",description:c.getString("Published and verified")},{key:"not_published_dismissed",description:c.getString("Dismissed, not published")},{key:"not_published_debunked",description:c.getString("Debunked, not published")},{key:"not_published_assigned",description:c.getString("Assigned, not published")}],a.totals={},a.groups.forEach(function(c){b.getResponses(c.key).onValue(function(b){a.totals[c.key]=b._meta.total})}),a.update=function(){a.groups.forEach(function(a){b.requests.push(a.key)})},a.update()}]),angular.module("citizendeskFrontendApp").service("ProcessedQueues",["SavedQueries","Bacon","api",function(a,b,c){function d(a){if(!(a in f.properties)){var c=new b.Bus;f.streams[a]=c,f.properties[a]=c.toProperty()}}var e=this,f={streams:{},properties:{}};this.requests=new b.Bus,this.getStream=function(a){return d(a),f.streams[a]},this.getResponses=function(a){return d(a),f.properties[a]},this.requests.onValue(function(b){c.reports.query({where:a.getWhere(b)}).then(function(a){e.getStream(b).push(a)})})}]),angular.module("citizendeskFrontendApp").controller("GenericReportListCtrl",["$scope","SavedQueries","$routeParams","SimpleReportList","gettextCatalog",function(a,b,c,d,e){a.description=e.getString("Matching reports"),d.init(a,b.getWhere(c.query))}]),angular.module("citizendeskFrontendApp").controller("AssignedToCtrl",["$scope","$routeParams","SimpleReportList","gettextCatalog",function(a,b,c,d){a.description=d.getString("Assigned to ")+b.name,c.init(a,{$and:[{"assignments.user_id":b.id},{$or:[{status:""},{status:{$exists:!1}},{"coverages.published":{$size:0}}]}]})}]),angular.module("citizendeskFrontendApp").directive("scrollTarget",["ScrollTo","$document",function(a,b){return{restrict:"A",scope:{scrollTarget:"="},link:function(c,d){a.target.onValue(function(a){a===c.scrollTarget&&b.scrollTo(d,200,900)})}}}]),angular.module("citizendeskFrontendApp").service("ScrollTo",["Bacon",function(a){this.targetStream=new a.Bus,this.target=this.targetStream.toProperty(),this.target.onValue(function(){})}]),angular.module("citizendeskFrontendApp").controller("IngestFromLocationCtrl",["$scope","$http","config","$window","Report","session","$timeout",function(a,b,c,d,e,f,g){function h(){return i&&g.cancel(i),a.showConfirm=!0,i=g(function(){a.showConfirm=!1},2e3)}var i;a.cancel=function(){d.history.back()},a.submit=function(){b.post(c.server.url+"proxy/ingest_from_location/",{location:a.location,user_id:f.identity._id}).then(function(){return a.repeat&&(a.location=""),h()}).then(function(){a.repeat||d.history.back()})}}]),angular.module("citizendeskFrontendApp").controller("ListFromTheWebCtrl",["$scope","SimpleReportList","gettextCatalog","$location","Report","lodash","reportStatuses",function(a,b,c,d,e,f,g){a.description=c.getString("Content from the Web"),a.disabled={},a.goAdd=function(){d.url("/ingest-from-location/")},b.init(a,{$and:[{"channels.type":"frontend"},{feed_type:"web_link"},{status:g("")},{assignments:{$size:0}}]}).then(function(){0===a.reports.length&&a.goAdd()}),a.dismissHandler=function(b){f.remove(a.reports,function(a){return a._id===b._id})},a.dismiss=e.getDismiss(a.disabled,a.dismissHandler)}]),angular.module("citizendeskFrontendApp").controller("ReportWebLinkCtrl",["$scope","$routeParams","Raven","api","$location","Report","Coverages","$window","screenSize","superdeskDate","PageBroker","SharedReport",function(a,b,c,d,e,f,g,h,i,j,k,l){l.get(b.id).property.onValue(function(b){a.report=b,a.$watch("report.session",function(b){a.encodedSession=encodeURIComponent(b)}),a.$watch("report.texts",function(){a.hasTranscript=a.report.texts[0].transcript},!0)}),a.toMediaSelection=function(){var b=a.report,c="/select-media-to-publish/"+b.feed_type+"/"+b._id;k.load(c,b)}}]),angular.module("citizendeskFrontendApp").controller("SelectMediaToPublishCtrl",["$scope","api","$routeParams","PageBroker","$location","$window","moveToTheBeginning",function(a,b,c,d,e,f,g){var h="/report-"+c.type+"/"+c.id;a.selected=0,a.disabled=!0,a.cancel=function(){f.history.back()},d.getData(h).then(function(b){a.report=b,a.disabled=!1}),a.submit=function(){a.disabled=!0;var c=angular.copy(a.report);c.media=g(a.selected,a.report.media),b.reports.save(c).then(function(){e.url(h)})}}]),angular.module("citizendeskFrontendApp").factory("moveToTheBeginning",function(){return function(a,b){var c=angular.copy(b),d=c.splice(a,1);return d.concat(c)}}),angular.module("citizendeskFrontendApp").controller("CommonReportDetailPartCtrl",["$scope","Coverages","SharedReport","$routeParams","lodash","screenSize","api","session","$http","config","superdeskDate","gettextCatalog","$window","Raven",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a){"steps"in a||g.steps.query().then(function(b){var c=b._items;0===c.length?n.raven.captureMessage("no validation steps for report detail"):a.steps=c.map(function(a){return a.done=!1,a})})}function p(a){return a.coverages&&a.coverages.published?a.coverages.published.length>0:!1}var q=c.get(d.id),r=e;a.reportStatusChange=function(b,c){if(b!==c){if(a.report.steps){var d=l.getString("This report is being marked as verified without going through the planned verification steps"),e=a.report.steps.every(function(a){return a.done});"verified"===b&&e===!1&&m.alert(d)}if("verified"===c){var f=l.getString("This report was marked as verified, and now it is marked as unverified again! This is a very bad practice, and should be avoided");m.alert(f)}a.report.status_updated=k.render(new Date),a.save()}},a.reportStepsChange=function(){a.report&&a.report.steps&&(a.verificationDisabled=a.report.steps.some(function(a){return a.mandatory&&!a.done}))},a.noticesOuterChange=function(b,c){b!==c&&(a.isPublished||(a.report.status_updated=k.render(new Date),a.save()))},a.commentChange=function(b,c){b!==c&&b===!1&&(a.report.notices_outer=[])},b.promise.then(function(b){a.coverages=b,q.property.onValue(function(c){b&&c.coverages&&c.coverages.published&&(a.selectedCoverage=r.find(b,{uuid:c.coverages.published[0]}))})}),q.property.onValue(function(b){a.report=b,o(a.report),a.isPublished=p(b),b.on_behalf_id&&g.users.getById(b.on_behalf_id).then(function(b){a.onBehalf=b}),b.notices_outer.length&&(a.comment=!0,a.commentCopy=b.notices_outer[0])}),q.property.take(1).onValue(function(){a.$watch("report.status",a.reportStatusChange),a.$watch("report.steps",a.reportStepsChange,!0),a.$watch("report.notices_outer",a.noticesOuterChange,!0),a.$watch("comment",a.commentChange)}),a.changeStep=function(b){b||m.alert("A validation step should never be unchecked, if you are unchecking now this means that the validation process was poor. Please be sure to avoid this in the future"),a.save()},a.publish=function(){a.disablePublish=!0,g.reports.save(a.report,{on_behalf_id:h.identity._id}).then(function(b){return i.post(j.server.url+"proxy/publish",{report:b._id,coverage:a.selectedCoverage.uuid})}).then(function(){q.update(),a.disablePublish=!1})},a.unpublish=function(){a.disablePublish=!0,i.post(j.server.url+"proxy/unpublish",{report:a.report._id,coverage:a.report.coverages.published[0]}).then(function(){q.update(),a.disablePublish=!1})},a.save=function(){a.status="info",a.alert="saving",a.disabled=!0,g.reports.save(a.report).then(function(b){a.status="success",a.alert="saved",a.disabled=!1,q.stream.push(b)})},a.largeScreen=f.is("md,lg")}]),angular.module("citizendeskFrontendApp").service("SharedReport",["Bacon","api","$rootScope",function(a,b,c){function d(c){var d=new a.Bus,f=d.toProperty();return b.reports.getById(c).then(function(a){d.push(a)}),{stream:d,property:f,remove:function(){delete e[c]},update:function(){b.reports.getById(c).then(function(a){d.push(a)})}}}var e={};c.$on("$locationChangeSuccess",function(){e={}}),this.get=function(a){return a in e||(e[a]=d(a)),e[a]}}]),angular.module("citizendeskFrontendApp").directive("reportAuthor",function(){return{restrict:"E",templateUrl:"views/directives/report-author.html",scope:{author:"="}}}),angular.module("citizendeskFrontendApp").controller("RemoveCoverageModalCtrl",["$scope","SavedQueries","api",function(a,b,c){a.loading=!0,a.disabled=!0,c.reports.query({where:b.parametric.publishedIn(a.coverage.uuid)}).then(function(b){a.reports=b._items,a.loading=!1,a.disabled=Boolean(a.reports.length)})}]),angular.module("citizendeskFrontendApp").controller("ReportsInCoverageCtrl",["$scope","SimpleReportList","SavedQueries","gettextCatalog","$routeParams",function(a,b,c,d,e){a.description=d.getString("Reports published in the coverage"),b.init(a,c.parametric.publishedIn(e.uniqueId))}]),angular.module("citizendeskFrontendApp").controller("ConfigureTimeZoneCtrl",["$scope",function(a){a.getOffset=function(){return(new Date).getTimezoneOffset()},a.watcher=function(){var b=a.getOffset(),c=-b;a.offset=c/60,a.offsetString=a.offset>0?"+"+a.offset:0===a.offset?"":String(a.offset)},a.$watch(a.watcher)}]),angular.module("citizendeskFrontendApp").controller("IdentityRecordCtrl",["$scope","$window","$routeParams","api",function(a,b,c,d){function e(){a.disabled=!0,d.identity_records.save(a.identity).then(function(){a.disabled=!1,b.history.back()})}a.disabled=!0,a.deleteDisabled=!0,a.cancel=function(){b.history.back()},a.submit=function(){e()},a.delete=function(){a.identity.deleted=!0,e()},c.id?(d.identity_records.getById(c.id).then(function(b){a.identity=b,a.disabled=!1}),d.citizen_aliases.query({where:JSON.stringify({identity_record_id:c.id})}).then(function(b){var c=b._items;a.aliases=c,0===c.length&&(a.deleteDisabled=!1)})):(a.identity={},a.disabled=!1,a.hideDelete=!0)}]),angular.module("citizendeskFrontendApp").controller("ListIdentityRecordsCtrl",["$scope","api","$routeParams","$location","$window",function(a,b,c,d,e){b.identity_records.query({where:JSON.stringify({deleted:{$ne:!0}})}).then(function(b){a.identities=b._items}),a.configuration=!c.aliasId,a.user="",a.$watch(function(a){return a.user},function(a,b,c){c.userFilter=""!==a?a:"do not filter"}),a.select=function(a){var b,e=a._id;b=c.aliasId?"/associate-alias/"+c.aliasId+"/"+e:"/identity-record/"+e,d.url(b)},a.add=function(){d.url("/identity-record/")},a.configuration||b.citizen_aliases.getById(c.aliasId).then(function(c){a.dissociate=function(){a.disabled=!0,delete c.identity_record_id,b.citizen_aliases.replace(c._links.self.href,c).then(function(){e.history.back()})}})}]),angular.module("citizendeskFrontendApp").controller("AssociateAliasCtrl",["$scope","$window","$routeParams","api","$q",function(a,b,c,d,e){a.loading=!0,e.all([d.citizen_aliases.getById(c.aliasId).then(function(b){a.alias=b}),d.identity_records.getById(c.identityId).then(function(b){a.identity=b})]).then(function(){a.loading=!1}),a.cancel=function(){b.history.back()},a.confirm=function(){var e=angular.copy(a.alias);e.identity_record_id=c.identityId,a.disabled=!0,d.citizen_aliases.save(e).then(function(){a.disabled=!1,b.history.go(-2)})}}]),angular.module("citizendeskFrontendApp").factory("allPages",["$q",function(a){function b(c,d){return c(d).then(function(e){return e._links.next?b(c,d+1):a.when(e)})}function c(a){return b(a,1)}return c}]),angular.module("citizendeskFrontendApp").factory("onRavenSuccess",["$window","$cookieStore","$rootScope",function(a,b,c){function d(){g&&b.remove(f)}function e(){var c=b.get(c);Boolean(c)?g=!0:(b.put(c,1),a.location.reload())}var f="on-raven-success-service-reload-counter",g=!1;return c.$on("locationChangeSuccess",d),e.onLocationChangeSuccess=d,e}]),angular.module("citizendeskFrontendApp").controller("ConfigureAccountCtrl",["$scope","$window","auth","session","$timeout","api",function(a,b,c,d,e,f){a.messages={},a.cancel=b.history.back,a.watch=function(){var b=a.newPassword!==a.confirmPassword;a.messages.passwordMismatch=b,a.mismatch=b;var c=a.mismatch,d=a.loading;a.disableSubmit=c||d},a.watchNew=function(b,c){b!==c&&(a.messages.shortPassword=!1)},a.$watch(a.watch),a.$watch("newPassword",a.watchNew),a.submit=function(){a.messages={},a.loading=!0,c.login(d.identity.username,a.currentPassword).then(function(){f.users.update(d.identity,{password:a.newPassword}).then(function(){a.messages.success=!0,a.loading=!1,e(function(){b.history.back()},2e3)},function(b){b.forEach(function(b){a.messages[b]=!0}),a.loading=!1})}).catch(function(b){b.forEach(function(b){a.messages[b]=!0}),"authenticationFailure"in a.messages&&e(function(){c.logout()},5e3),a.loading=!1})}}]),angular.module("citizendeskFrontendApp").service("ErrorPolice",["lodash","safeAccess",function(a,b){var c=this;this.identifiers={shortPassword:function(a){var c=422===a.status,d=b(a,"data._issues.password.minlength");return c&&d},authenticationFailure:function(a){return Boolean(b(a,"data._issues.credentials"))}},this.identify=function(b){var d=[];return a.forEach(c.identifiers,function(a,c){a(b)&&d.push(c)}),d}}]),angular.module("citizendeskFrontendApp").factory("safeAccess",function(){return safeAccess});